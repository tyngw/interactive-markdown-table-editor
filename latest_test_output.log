
> interactive-markdown-table-editor@1.2.0 test
> npm run compile && npm run lint && node ./out/test/runTest.js


> interactive-markdown-table-editor@1.2.0 compile
> npm run lint && tsc -p ./ && npm run build-webview && npm run copy-mock


> interactive-markdown-table-editor@1.2.0 lint
> eslint src --ext ts


> interactive-markdown-table-editor@1.2.0 build-webview
> cd webview-react && npm install && npm run build


up to date, audited 529 packages in 451ms

88 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

> markdown-table-editor-webview@1.0.0 build
> vite build

vite v7.2.6 building client environment for production...
(node:6463) ExperimentalWarning: CommonJS module /Users/tyngw/Documents/workspace/markdown-table-editor/webview-react/vite.config.ts is loading ES Module /Users/tyngw/Documents/workspace/markdown-table-editor/webview-react/node_modules/vite/dist/node/index.js using require().
Support for loading ES Module in require() is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
transforming...
âœ“ 127 modules transformed.

(!) outDir /Users/tyngw/Documents/workspace/markdown-table-editor/out/webview is not inside project root and will not be emptied.
Use --emptyOutDir to override.

rendering chunks...
computing gzip size...
../out/webview/index.html         1.01 kB â”‚ gzip:   0.53 kB
../out/webview/assets/index.js  388.57 kB â”‚ gzip: 112.33 kB
âœ“ built in 1.40s

> interactive-markdown-table-editor@1.2.0 copy-mock
> mkdir -p out/src/mock out/mock && cp test/mock/* out/src/mock/ && cp test/mock/* out/mock/


> interactive-markdown-table-editor@1.2.0 lint
> eslint src --ext ts

- Resolving version...
âœ” Validated version: 1.109.3
âœ” Found existing install in /Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3
[90m[main 2026-02-14T01:19:20.690Z][0m update#setState disabled
[90m[main 2026-02-14T01:19:20.691Z][0m update#ctor - updates are disabled by the environment
Unable to read file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/mock/package.json' (Error: Unable to resolve nonexistent file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/mock/package.json')
Unable to read file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/package.json' (Error: Unable to resolve nonexistent file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/package.json')
Unable to read file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/src-instrumented/package.json' (Error: Unable to resolve nonexistent file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/src-instrumented/package.json')
Unable to read file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/package.json' (Error: Unable to resolve nonexistent file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/package.json')
Unable to read file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/webview/package.json' (Error: Unable to resolve nonexistent file '/Users/tyngw/Documents/workspace/markdown-table-editor/out/webview/package.json')
MCP Registry configured: https://api.mcp.github.com
Settings Sync: Account status changed from uninitialized to unavailable
Started local extension host with pid 7155.
[0m[0m
[0m  VS Code Extension Tests[0m
  [32m  âœ”[0m[90m Should be able to open markdown file[0m
  [32m  âœ”[0m[90m Should be able to execute openEditor command with document[0m[31m (103ms)[0m
  [32m  âœ”[0m[90m Markdown file operations should work[0m
  [32m  âœ”[0m[90m Should be able to read document content[0m
  [32m  âœ”[0m[90m Should be able to modify and revert document[0m[31m (93ms)[0m
  [32m  âœ”[0m[90m Extension workspace integration[0m
  [32m  âœ”[0m[90m Table parsing capabilities[0m
[0m  GitDiffCoordinator[0m
  [32m  âœ”[0m[90m skips redundant git diff updates when content is unchanged[0m
  [32m  âœ”[0m[90m resetLastSent initializes lastSentDiffMap with empty arrays[0m
[GitDiffCoordinator] Failed to calculate git diff: Error: Git error
	at Object.getGitDiffForTable (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/activation/gitDiffCoordinator.test.js:101:53)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/gitDiffCoordinator.js:34:61
	at Array.map (<anonymous>)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/gitDiffCoordinator.js:31:74
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/activation/gitDiffCoordinator.test.js:109:9)
  [32m  âœ”[0m[90m handles diff provider error gracefully[0m
  [32m  âœ”[0m[90m handles comparison error by falling back to direct update[0m
  [32m  âœ”[0m[90m sends update when diff content changes[0m
  [32m  âœ”[0m[90m handles comparison error in lastSentDiffMap and falls back to direct update[0m
[GitDiffCoordinator] Diff calculation chain error: Error: previous chain failed
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/activation/gitDiffCoordinator.test.js:232:49)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m scheduleGitDiffCalculation handles chain error via catch[0m
[0m  PanelSessionManager[0m
  [32m  âœ”[0m[90m normalizes various URI inputs[0m
  [32m  âœ”[0m[90m resolves panel and managers by panelId preference[0m
  [32m  âœ”[0m[90m falls back to uri when panel is not tracked yet[0m
  [32m  âœ”[0m[90m normalizeUri handles falsy value[0m
  [32m  âœ”[0m[90m normalizeUri handles undefined[0m
  [32m  âœ”[0m[90m normalizeUri handles object with toString[0m
  [32m  âœ”[0m[90m normalizeUri handles object with toString returning invalid URI[0m
  [32m  âœ”[0m[90m normalizeUri handles object without toString[0m
  [32m  âœ”[0m[90m resolvePanelContext resolves tableManagersMap from candidateKeys fallback[0m
  [32m  âœ”[0m[90m getManagers returns undefined for unknown key[0m
  [32m  âœ”[0m[90m getPanelAndManagers returns panel and managers[0m
  [32m  âœ”[0m[90m clearAll clears all managers[0m
  [32m  âœ”[0m[90m normalizeUri handles empty string[0m
  [32m  âœ”[0m[90m normalizeUri handles string with double colons (:: check)[0m
  [31m  1) normalizeUri handles file URI with no path[0m
  [32m  âœ”[0m[90m normalizeUri string catch block when Uri.parse throws (L29)[0m
  [32m  âœ”[0m[90m normalizeUri toString catch block when Uri.parse throws (L50)[0m
  [31m  2) normalizeUri handles vscode.Uri instance with double colon toString[0m
  [32m  âœ”[0m[90m normalizeUri handles object with toString returning non-parsable URI[0m
  [32m  âœ”[0m[90m normalizeUri handles object with toString that produces valid URI[0m
  [32m  âœ”[0m[90m normalizeUri string catch block - Uri.parse throws for string input (L29)[0m
  [32m  âœ”[0m[90m normalizeUri toString object catch block - Uri.parse throws (L50)[0m
[0m  CommandRegistrar Test Suite[0m
  [32m  âœ”[0m[90m should construct without errors[0m
  [32m  âœ”[0m[90m register should register external and internal commands[0m
  [32m  âœ”[0m[90m register should add subscriptions to context[0m
  [31m  3) openEditor command with no active editor shows error[0m
  [32m  âœ”[0m[90m openEditor command with URI and no tables shows info message[0m
  [32m  âœ”[0m[90m openEditor command with tables creates panel[0m
  [32m  âœ”[0m[90m openEditorNewPanel creates new panel with unique ID[0m
  [32m  âœ”[0m[90m selectTheme calls themeApplier.showThemePicker[0m
  [32m  âœ”[0m[90m requestTableData with no uri returns early[0m
  [32m  âœ”[0m[90m requestTableData with valid uri but no panel returns early[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [31m  4) requestTableData with valid data sends table data[0m
  [32m  âœ”[0m[90m updateCell with no URI returns early[0m
  [32m  âœ”[0m[90m updateCell with valid data and auto-save saves file[0m
  [32m  âœ”[0m[90m updateCell with auto-save disabled sets dirty state[0m
Error in updateCell: Error: Update failed
	at Object.updateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:301:39)
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:338:34)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:309:9)
  [32m  âœ”[0m[90m updateCell error sends error message[0m
  [32m  âœ”[0m[90m bulkUpdateCells with missing updates returns early[0m
  [32m  âœ”[0m[90m bulkUpdateCells with valid data processes updates[0m
  [32m  âœ”[0m[90m updateHeader with valid data updates header[0m
  [32m  âœ”[0m[90m sort command delegates to handler[0m
  [32m  âœ”[0m[90m moveRow command delegates to handler[0m
  [32m  âœ”[0m[90m moveColumn command delegates to handler[0m
  [32m  âœ”[0m[90m moveRow with no indices sends error[0m
  [32m  âœ”[0m[90m addRow command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m deleteRow command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m addColumn command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m deleteColumn command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m deleteRows command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m deleteColumns command delegates to tableEditRunner[0m
[CommandRegistrar] handleForceFileSave: Missing uri or panelId
  [32m  âœ”[0m[90m forceFileSave with missing uri/panelId returns early[0m
  [32m  âœ”[0m[90m forceFileSave with valid data saves all tables[0m
  [32m  âœ”[0m[90m exportCSV with no panel returns early[0m
  [32m  âœ”[0m[90m importCSV with no panel returns early[0m
  [32m  âœ”[0m[90m openEditor with existing active panel clears previous session[0m
Error opening table editor: Error: Read error
	at deps.fileHandler.readMarkdownFile (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:585:19)
	at CommandRegistrar.handleOpenEditor (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:187:52)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:33:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:592:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m openEditor handles error gracefully[0m
  [32m  âœ”[0m[90m updateCell with Invalid cell position attempts refresh[0m
  [32m  âœ”[0m[90m sort with missing panel returns early[0m
  [32m  âœ”[0m[90m sort with missing tableManagersMap sends error[0m
  [32m  âœ”[0m[90m bulkUpdateCells that needs row/column expansion[0m
  [32m  âœ”[0m[90m updateHeader with Invalid position attempts refresh[0m
  [32m  âœ”[0m[90m moveColumn with no indices sends error[0m
Error in sort: Error: Sort failed
	at Object.sortByColumn (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:740:53)
	at CommandRegistrar.handleSort (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:613:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:148:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:747:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m sort error sends error to panel[0m
[CommandRegistrar] handleForceFileSave failed: Error: Serialize failed
	at Object.serializeToMarkdown (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:757:48)
	at CommandRegistrar.handleForceFileSave (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:1018:58)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:163:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:765:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m forceFileSave error sends error to panel[0m
  [32m  âœ”[0m[90m exportCSV with valid data and no save dialog cancellation[0m
  [32m  âœ”[0m[90m exportCSV with empty content sends error[0m
  [32m  âœ”[0m[90m sort with auto-save disabled sets dirty state[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [32m  âœ”[0m[90m requestTableData with no tables sends error[0m
Error in requestTableData: Error: File not found
	at vscode.workspace.openTextDocument (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:855:65)
	at CommandRegistrar.handleRequestTableData (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:245:48)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:45:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:859:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m requestTableData error sends error to panel[0m
  [32m  âœ”[0m[90m updateHeader with auto-save disabled sets dirty state[0m
Could not refresh table data: Error: Table index 0 not found in refreshed data
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:552:35)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:904:9)
Error in updateHeader: Error: Non-Invalid error
	at Object.updateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:896:41)
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:536:34)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:904:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m updateHeader error sends error and headerUpdateError[0m
Error in bulkUpdateCells: Error: Batch failed
	at Object.batchUpdateCells (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:915:45)
	at CommandRegistrar.handleBulkUpdateCells (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:462:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:51:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:925:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m bulkUpdateCells error sends error to panel[0m
Error in moveRow: Error: Move failed
	at Object.moveRows (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:940:49)
	at CommandRegistrar.handleMoveRow (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:683:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:151:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:949:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m moveRow error sends error to panel[0m
Error in moveColumn: Error: Move failed
	at Object.moveColumns (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:961:52)
	at CommandRegistrar.handleMoveColumn (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:744:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:154:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:970:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m moveColumn error sends error to panel[0m
  [32m  âœ”[0m[90m exportCSV without panel returns early[0m
  [32m  âœ”[0m[90m exportCSV with empty csvContent sends error[0m
  [32m  âœ”[0m[90m exportCSV with missing URI sends error[0m
  [32m  âœ”[0m[90m exportCSV with save dialog cancelled does nothing[0m
  [31m  5) exportCSV with save dialog accepted writes file[0m
  [31m  6) exportCSV with sjis encoding[0m
Error in exportCSV: Error: dialog fail
	at vscode.window.showSaveDialog (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1093:60)
	at CommandRegistrar.handleExportCSV (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:805:49)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:157:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1097:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m exportCSV error is caught and sent to panel[0m
  [32m  âœ”[0m[90m importCSV without panel returns early[0m
  [32m  âœ”[0m[90m importCSV without tableManagersMap sends error[0m
Error in importCSV: Error: dialog fail
	at vscode.window.showOpenDialog (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1145:60)
	at CommandRegistrar.handleImportCSV (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:877:50)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:160:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1149:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m importCSV error is caught and sent to panel[0m
  [32m  âœ”[0m[90m importCSV with cancelled open dialog returns early[0m
  [32m  âœ”[0m[90m forceFileSave with valid data saves all tables[0m
[CommandRegistrar] handleForceFileSave: Missing uri or panelId
  [32m  âœ”[0m[90m forceFileSave with missing panelId returns early[0m
[CommandRegistrar] handleForceFileSave: No table managers found
  [32m  âœ”[0m[90m forceFileSave with no table managers returns early[0m
[CommandRegistrar] handleForceFileSave failed: Error: save fail
	at deps.fileHandler.updateTableByIndex (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1229:67)
	at CommandRegistrar.handleForceFileSave (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:1020:40)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:163:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1233:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m forceFileSave error sends error to panel[0m
  [32m  âœ”[0m[90m updateCell with auto-save sends save notifications[0m
  [32m  âœ”[0m[90m updateCell with auto-save disabled sets dirty state[0m
  [32m  âœ”[0m[90m updateHeader with auto-save calls updateTableByIndex[0m
  [32m  âœ”[0m[90m sort command with auto-save sends save notifications[0m
  [32m  âœ”[0m[90m addRow command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m deleteRow command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m addColumn command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m deleteColumn command delegates to tableEditRunner[0m
  [32m  âœ”[0m[90m moveRow success sends success and schedules git diff[0m
  [32m  âœ”[0m[90m moveColumn success sends success[0m
  [32m  âœ”[0m[90m openEditorNewPanel with tables creates new panel[0m
  [32m  âœ”[0m[90m bulkUpdateCells with auto-save sends notifications[0m
  [32m  âœ”[0m[90m addRow callback: getSuccessMessage singular for count=1[0m
  [32m  âœ”[0m[90m addRow callback: getSuccessMessage plural for count>1[0m
  [32m  âœ”[0m[90m addRow callback: mutate calls manager.addRow[0m
  [32m  âœ”[0m[90m addRow callback: getErrorMessage with Error[0m
  [32m  âœ”[0m[90m deleteRow callback: mutate validates index[0m
  [32m  âœ”[0m[90m addColumn callback: singular and plural messages[0m
  [32m  âœ”[0m[90m deleteColumn callback: mutate validates index[0m
  [32m  âœ”[0m[90m deleteRows callback: undoDescription, successMessage, mutate[0m
  [32m  âœ”[0m[90m deleteColumns callback: undoDescription, successMessage, mutate[0m
  [32m  âœ”[0m[90m openEditorNewPanel sets managers with unique panelId[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [32m  âœ”[0m[90m requestTableData with forceRefresh=true does not sendSuccess[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [31m  7) requestTableData with forceRefresh=false sends success[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [31m  8) requestTableData with explicit panelId uses it for getPanel[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
[File Watcher (node.js)] Watcher shutdown because watched path got deleted
  [31m  9) requestTableData git diff IIFE error falls back to updateTableData[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [32m  âœ”[0m[90m requestTableData no tables sends error[0m
Error in requestTableData: Error: File not found
	at vscode.workspace.openTextDocument (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1700:65)
	at CommandRegistrar.handleRequestTableData (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:245:48)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:45:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1703:86)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m requestTableData error sends error to panel[0m
  [32m  âœ”[0m[90m updateCell no tableManagersMap sends error[0m
  [32m  âœ”[0m[90m updateCell missing table manager for specific index sends error[0m
  [32m  âœ”[0m[90m updateCell Invalid cell position attempts refresh and retries[0m
Could not refresh table data: Error: Table index 5 not found in refreshed data
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:354:35)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1780:9)
Error in updateCell: Error: Invalid cell position
	at Object.updateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1771:39)
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:338:34)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1780:9)
  [32m  âœ”[0m[90m updateCell Invalid position refresh fails when table index out of range[0m
Error in updateCell: Error: Some other error
	at Object.updateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1793:47)
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:338:34)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1798:9)
  [32m  âœ”[0m[90m updateCell non-Invalid error is propagated to error handler[0m
  [32m  âœ”[0m[90m updateCell save-skipped when updateTableByIndex returns false[0m
Error in updateCell: Error: cell fail
	at Object.updateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1834:47)
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:338:34)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1839:9)
  [32m  âœ”[0m[90m updateCell error catch resolves panel from panelId[0m
  [32m  âœ”[0m[90m bulkUpdateCells save-skipped when updateTableByIndex returns false[0m
  [32m  âœ”[0m[90m bulkUpdateCells auto-save disabled sets dirty state[0m
  [32m  âœ”[0m[90m bulkUpdateCells missing table manager for index sends error[0m
Error in bulkUpdateCells: Error: batch fail
	at Object.batchUpdateCells (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1909:53)
	at CommandRegistrar.handleBulkUpdateCells (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:462:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:51:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1916:85)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m bulkUpdateCells error catch sends error via panelId[0m
  [32m  âœ”[0m[90m updateHeader no tableManagersMap sends error[0m
  [32m  âœ”[0m[90m updateHeader missing table manager sends error[0m
  [32m  âœ”[0m[90m updateHeader Invalid position attempts refresh and retries[0m
Could not refresh table data: Error: Table index 5 not found in refreshed data
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:552:35)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1991:9)
Error in updateHeader: Error: Invalid header
	at Object.updateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1982:41)
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:536:34)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:1991:82)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m updateHeader Invalid position refresh fails when table index out of range[0m
Could not refresh table data: Error: Table index 0 not found in refreshed data
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:552:35)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2009:9)
Error in updateHeader: Error: Non-Invalid error
	at Object.updateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2004:49)
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:536:34)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2009:82)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m updateHeader non-Invalid error sends error and headerUpdateError[0m
  [32m  âœ”[0m[90m updateHeader auto-save disabled sets dirty state[0m
  [32m  âœ”[0m[90m sort missing table manager sends error[0m
  [32m  âœ”[0m[90m sort save-skipped when updateTableByIndex returns false[0m
  [32m  âœ”[0m[90m moveRow no tableManagersMap sends error[0m
  [32m  âœ”[0m[90m moveRow missing table manager sends error[0m
  [32m  âœ”[0m[90m moveRow uses indices array, deduplicates and sorts[0m
  [32m  âœ”[0m[90m moveRow save-skipped when updateTableByIndex returns false[0m
Error in moveRow: Error: Move failed
	at Object.moveRows (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2169:49)
	at CommandRegistrar.handleMoveRow (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:683:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:151:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2177:77)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m moveRow error sends error to panel[0m
  [32m  âœ”[0m[90m moveColumn full success path with save notifications[0m
  [32m  âœ”[0m[90m moveColumn no tableManagersMap sends error[0m
  [32m  âœ”[0m[90m moveColumn missing table manager sends error[0m
  [32m  âœ”[0m[90m moveColumn uses indices array, deduplicates and sorts[0m
  [32m  âœ”[0m[90m moveColumn save-skipped when updateTableByIndex returns false[0m
Error in moveColumn: Error: Move col fail
	at Object.moveColumns (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2300:52)
	at CommandRegistrar.handleMoveColumn (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:744:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:154:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2308:80)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m moveColumn error sends error to panel[0m
  [31m  10) exportCSV sjis with replacements user accepts conversion[0m
  [31m  11) exportCSV sjis with replacements user selects doNotConvert[0m
  [32m  âœ”[0m[90m exportCSV sjis with replacements user cancels warning dialog[0m
  [31m  12) exportCSV sjis without replacements writes directly[0m
Error in exportCSV: Error: dialog fail
	at vscode.window.showSaveDialog (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2434:60)
	at CommandRegistrar.handleExportCSV (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:805:49)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:157:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2437:79)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m exportCSV error sends error to panel[0m
  [32m  âœ”[0m[90m importCSV missing table manager sends error[0m
  [31m  13) importCSV successful import replaces contents[0m
  [31m  14) importCSV user declines confirmation[0m
  [31m  15) importCSV empty CSV sends error[0m
  [32m  âœ”[0m[90m handleFileChange markdown file change updates panels[0m
  [32m  âœ”[0m[90m handleFileChange non-markdown file is ignored[0m
  [32m  âœ”[0m[90m handleFileChange no panels for file does nothing[0m
  [32m  âœ”[0m[90m handleFileChange no tables returns early[0m
Error updating panels after file change: Error: parse error
	at deps.markdownParser.parseDocument (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2653:59)
	at CommandRegistrar.handleFileChange (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:951:45)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:169:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2663:19)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m handleFileChange error sends error to panels[0m
  [32m  âœ”[0m[90m handleFileChange multiple panels all get updated[0m
  [32m  âœ”[0m[90m forceFileSave saves multiple tables[0m
  [31m  16) importCSV with all whitespace CSV sends csvNoValues error[0m
  [31m  17) exportCSV SJIS encoding with iconv-lite failure falls back to UTF-8[0m
  [32m  âœ”[0m[90m forceFileSave no panel still saves and clears dirty[0m
[Extension] Diff calculation scheduling failed: Error: diff scheduling error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2810:83)
	at CommandRegistrar.handleSort (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:643:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:148:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:2814:9)
  [32m  âœ”[0m[90m sort: scheduleGitDiffCalculation rejection is caught[0m
  [31m  18) exportCSV: iconv-lite failure falls back to UTF-8[0m
[CommandRegistrar] handleForceFileSave: No table managers found
  [31m  19) forceFileSave: scheduleGitDiffCalculation rejection is caught[0m
  [31m  20) openEditor: activeEditor.document.uri ã‚’targetUriã«è¨­å®š (JS L182)[0m
  [31m  21) openEditor: targetUri ãŒ null ã®å ´åˆ throw (JS L185)[0m
  [32m  âœ”[0m[90m requestTableData: panel ãŒ null ã§ return (JS L324)[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [31m  22) requestTableData: updateGitDiffå¤±æ•—å¾Œã® fallback updateTableData ã‚‚å¤±æ•— (JS L288)[0m
  [32m  âœ”[0m[90m updateCell: uriç„¡ã—ã§ getActivePanelUri ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ (JS L422)[0m
  [32m  âœ”[0m[90m updateCell: panel ãŒ null ã§ return (JS L430)[0m
  [32m  âœ”[0m[90m updateCell: tableManagersMap ãŒ null ã§ sendError (JS L434-435)[0m
[Extension] Diff calculation scheduling failed: Error: diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3053:83)
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:395:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3057:9)
  [32m  âœ”[0m[90m updateCell: scheduleGitDiffCalculation rejection ã¯ catch ã•ã‚Œã‚‹ (JS L396)[0m
[Extension] Diff calculation scheduling failed: Error: bulk diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3083:83)
	at CommandRegistrar.handleBulkUpdateCells (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:492:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:51:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3087:9)
  [32m  âœ”[0m[90m bulkUpdateCells: scheduleGitDiffCalculation rejection ã¯ catch ã•ã‚Œã‚‹ (JS L493)[0m
  [32m  âœ”[0m[90m updateHeader: uriç„¡ã—ã§ getActivePanelUri ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ (JS L514)[0m
  [32m  âœ”[0m[90m updateHeader: uriString ãŒç©ºã§ return (JS L518)[0m
  [32m  âœ”[0m[90m updateHeader: panel ãŒ null ã§ return (JS L522)[0m
Error in updateHeader: TypeError: Cannot read property
	at Object.updateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3152:41)
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:536:34)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3159:15)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m updateHeader: non-Invalid positionError ãŒ throw ã•ã‚Œã‚‹ (JS L561)[0m
[Extension] Diff calculation scheduling failed: Error: header diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3179:83)
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:576:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3183:9)
  [32m  âœ”[0m[90m updateHeader: scheduleGitDiffCalculation rejection ã¯ catch ã•ã‚Œã‚‹ (JS L577)[0m
  [32m  âœ”[0m[90m sort: panel ãŒ null ã§ return (JS L601)[0m
[Extension] Diff calculation scheduling failed: Error: sort diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3227:83)
	at CommandRegistrar.handleSort (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:643:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:148:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3230:9)
  [32m  âœ”[0m[90m sort: scheduleGitDiffCalculation catch ã‚«ãƒãƒ¬ãƒƒã‚¸ç¢ºèª (JS L644)[0m
  [32m  âœ”[0m[90m moveRow: uriString ãŒ null ã§ return (JS L661)[0m
  [32m  âœ”[0m[90m moveRow: panel ãŒ null ã§ return (JS L664)[0m
[Extension] Diff calculation scheduling failed: Error: moveRow diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3287:83)
	at CommandRegistrar.handleMoveRow (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:704:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:151:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3290:9)
  [32m  âœ”[0m[90m moveRow: scheduleGitDiffCalculation rejection ã¯ catch ã•ã‚Œã‚‹ (JS L705)[0m
  [32m  âœ”[0m[90m moveColumn: uriString ãŒ null ã§ return (JS L722)[0m
  [32m  âœ”[0m[90m moveColumn: panel ãŒ null ã§ return (JS L725)[0m
[Extension] Diff calculation scheduling failed: Error: moveCol diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3344:83)
	at CommandRegistrar.handleMoveColumn (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:765:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:154:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3347:9)
  [32m  âœ”[0m[90m moveColumn: scheduleGitDiffCalculation rejection ã¯ catch ã•ã‚Œã‚‹ (JS L766)[0m
  [31m  23) exportCSV: iconv-lite encode å¤±æ•—ã§ UTF-8 ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ (JS L837-838)[0m
[CommandRegistrar] handleForceFileSave: Git diff calculation failed: Error: forceFileSave diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3411:83)
	at CommandRegistrar.handleForceFileSave (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:1029:41)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:163:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3414:9)
  [32m  âœ”[0m[90m forceFileSave: scheduleGitDiffCalculation catch ãƒ‘ã‚¹ç¢ºèª (JS L1030)[0m
  [31m  24) openEditor: activeEditor fallback to document.uri (JS L182)[0m
  [31m  25) openEditor: targetUri null throws (JS L185)[0m
  [32m  âœ”[0m[90m requestTableData: panel null returns early (JS L324)[0m
Error in requestTableData: CodeExpectedError: cannot open file:///test/sample.md. Detail: Unable to read file '/test/sample.md' (Error: Unable to resolve nonexistent file '/test/sample.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [32m  âœ”[0m[90m requestTableData: fallback updateTableData catch (JS L288)[0m[33m (57ms)[0m
  [32m  âœ”[0m[90m updateCell: uriæœªæŒ‡å®šã§ activePanelUri ã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ (JS L422)[0m
  [32m  âœ”[0m[90m updateCell: panel null returns early (JS L430)[0m
  [32m  âœ”[0m[90m updateCell: tableManagersMap null sends error (JS L434-435)[0m
[Extension] Diff calculation scheduling failed: Error: diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3570:83)
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:395:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3573:9)
  [32m  âœ”[0m[90m updateCell: scheduleGitDiffCalculation rejection is caught (JS L396)[0m
Error in updateCell: Error: Some other error
	at Object.updateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3590:47)
	at CommandRegistrar.handleUpdateCell (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:338:34)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:48:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3596:9)
  [32m  âœ”[0m[90m updateCell: positionError re-throw for non-invalid-cell-position (JS L561)[0m
Error in bulkUpdateCells: TypeError: tableDataManager.batchUpdateCells is not a function
	at CommandRegistrar.handleBulkUpdateCells (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:462:30)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:51:24
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3619:85)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m bulkUpdateCells: scheduleGitDiffCalculation rejection is caught (JS L493)[0m
  [32m  âœ”[0m[90m updateHeader: uriæœªæŒ‡å®šã§ activePanelUri ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ (JS L514)[0m
  [32m  âœ”[0m[90m updateHeader: uriString empty returns early (JS L518)[0m
  [32m  âœ”[0m[90m updateHeader: panel null returns early (JS L522)[0m
[Extension] Diff calculation scheduling failed: Error: diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3675:83)
	at CommandRegistrar.handleUpdateHeader (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:576:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:54:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3678:9)
  [32m  âœ”[0m[90m updateHeader: scheduleGitDiffCalculation rejection is caught (JS L577)[0m
  [32m  âœ”[0m[90m deleteRows: panel null returns early (JS L601)[0m
  [32m  âœ”[0m[90m deleteRows: scheduleGitDiffCalculation rejection is caught (JS L644)[0m
  [32m  âœ”[0m[90m moveRow: uriString null returns early (JS L661)[0m
  [32m  âœ”[0m[90m moveRow: panel null returns early (JS L664)[0m
[Extension] Diff calculation scheduling failed: Error: diff error
	at deps.gitDiffCoordinator.scheduleGitDiffCalculation (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3786:83)
	at CommandRegistrar.handleMoveRow (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:704:37)
	at async /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:151:13
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/commandRegistrar.test.js:3789:9)
  [32m  âœ”[0m[90m moveRow: scheduleGitDiffCalculation rejection is caught (JS L705)[0m
  [32m  âœ”[0m[90m moveColumn: uriString null returns early (JS L722)[0m
  [32m  âœ”[0m[90m moveColumn: panel null returns early (JS L725)[0m
  [32m  âœ”[0m[90m bulkUpdateCells: uriæœªæŒ‡å®šã§ activePanelUri ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ (JS L422)[0m
  [32m  âœ”[0m[90m bulkUpdateCells: panel null returns early (JS L430)[0m
  [32m  âœ”[0m[90m bulkUpdateCells: tableManagersMap null sends error (JS L434-435)[0m
[0m  Core Module System Tests[0m
  [32m  âœ”[0m[90m React webview build exists[0m
  [32m  âœ”[0m[90m Webview index.html is valid[0m
  [32m  âœ”[0m[90m Webview assets are built[0m
[0m  CSP and Webview HTML Tests[0m
WebviewManager: Starting async initialization...
  [32m  âœ”[0m[90m CSP meta tag should be inside head element[0m
WebviewManager: React build directory verified
  [32m  âœ”[0m[90m Asset URLs should be properly resolved[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
  [32m  âœ”[0m[90m HTML structure should be valid after processing[0m
[0m  CSV Export Interface Tests[0m
[0m    CSV Export Message Validation[0m
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should validate complete CSV export message[0m
WebviewManager: React build directory verified
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should validate CSV export message with Shift_JIS encoding[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build directory verified
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should reject CSV export message with missing csvContent[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build directory verified
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should reject CSV export message with empty csvContent[0m
WebviewManager: React build directory verified
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should reject CSV export message with undefined csvContent[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: Starting async initialization...
WebviewManager: React build directory verified
    [32m  âœ”[0m[90m should handle CSV export message with missing filename[0m
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle CSV export message with missing encoding[0m
[0m    CSV Export Data Structure Tests[0m
WebviewManager: React build directory verified
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle complex CSV content with special characters[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build directory verified
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build directory verified
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle CSV content with Japanese characters for Shift_JIS[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle large CSV content[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build directory verified
WebviewManager: React build directory verified
[0m    CSV Export Command Execution Tests[0m
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should execute exportCSV command with correct data structure[0m
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should execute exportCSV command with Shift_JIS encoding[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build directory verified
WebviewManager: Starting async initialization...
WebviewManager: React build directory verified
    [32m  âœ”[0m[90m should handle missing optional parameters gracefully[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
[0m    Error Handling Tests[0m
WebviewManager: Starting async initialization...
WebviewManager: React build directory verified
    [32m  âœ”[0m[90m should handle malformed message data gracefully[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle message without data property[0m
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle invalid encoding values[0m
WebviewManager: React build directory verified
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
[0m    Regression Tests for Buffer.from Error[0m
WebviewManager: Starting async initialization...
WebviewManager: React build directory verified
    [32m  âœ”[0m[90m should prevent undefined csvContent from reaching Buffer.from[0m
WebviewManager: React build directory verified
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should ensure data structure consistency[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build directory verified
[0m  CSV Exporter Webview Tests[0m
[0m    CSV Content Generation Tests[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
    [32m  âœ”[0m[90m should generate basic CSV content[0m
WebviewManager: React build directory verified
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
    [32m  âœ”[0m[90m should handle CSV fields with special characters[0m
    [32m  âœ”[0m[90m should handle null and undefined values[0m
WebviewManager: React build index.html verified
WebviewManager: Async initialization completed
    [32m  âœ”[0m[90m should handle Japanese characters[0m
[0m    CSV Field Escaping Tests[0m
    [32m  âœ”[0m[90m should escape fields with commas[0m
    [32m  âœ”[0m[90m should escape fields with quotes[0m
    [32m  âœ”[0m[90m should escape fields with newlines[0m
    [32m  âœ”[0m[90m should not escape simple fields[0m
    [32m  âœ”[0m[90m should convert br tags to newlines[0m
    [32m  âœ”[0m[90m should convert various br tag formats to newlines[0m
    [32m  âœ”[0m[90m should handle multiple br tags[0m
    [32m  âœ”[0m[90m should handle null and undefined[0m
    [32m  âœ”[0m[90m should convert numbers to strings[0m
[0m    Filename Generation Tests[0m
    [32m  âœ”[0m[90m should generate filename from fileInfo.fileNameWithoutExt[0m
    [32m  âœ”[0m[90m should generate filename from fileInfo.fileName[0m
    [32m  âœ”[0m[90m should generate filename from documentUri[0m
    [32m  âœ”[0m[90m should generate default timestamp filename[0m
[0m    Export Process Tests[0m
Success: CSV export initiated (UTF-8)...
    [32m  âœ”[0m[90m should export CSV with UTF-8 encoding[0m
Success: CSV export initiated (Shift_JIS)...
    [32m  âœ”[0m[90m should export CSV with Shift_JIS encoding[0m
    [32m  âœ”[0m[90m should handle missing table data[0m
    [32m  âœ”[0m[90m should handle missing VSCode API[0m
Success: CSV export initiated (UTF-8)...
    [32m  âœ”[0m[90m should use displayData over tableData[0m
[0m    Error Handling Tests[0m
CSVExporter: Export failed Error: CSV generation failed
	at CSVExporter.generateCSVContent (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-exporter-webview.test.js:394:23)
	at Object.exportToCSV (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-exporter-webview.test.js:93:45)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-exporter-webview.test.js:401:29)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
    [32m  âœ”[0m[90m should handle CSV generation errors[0m
CSVExporter: Export failed Error: Filename generation failed
	at CSVExporter.getDefaultCSVFilename (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-exporter-webview.test.js:417:23)
	at Object.exportToCSV (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-exporter-webview.test.js:95:43)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-exporter-webview.test.js:424:29)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
    [32m  âœ”[0m[90m should handle filename generation errors[0m
[0m  csvUtils Test Suite[0m
[0m    detectTextEncoding[0m
    [32m  âœ”[0m[90m should detect UTF-8 BOM[0m
    [32m  âœ”[0m[90m should detect UTF-8 without BOM[0m
    [32m  âœ”[0m[90m should detect SJIS when replacement characters appear[0m
    [32m  âœ”[0m[90m should detect UTF-8 for ASCII text[0m
    [32m  âœ”[0m[90m should detect UTF-8 for valid Japanese UTF-8[0m
    [32m  âœ”[0m[90m should handle empty buffer[0m
[0m    decodeBuffer[0m
    [32m  âœ”[0m[90m should decode UTF-8 buffer[0m
    [32m  âœ”[0m[90m should decode SJIS buffer[0m
    [32m  âœ”[0m[90m should fallback to UTF-8 for invalid SJIS[0m
[0m    parseCsv[0m
    [32m  âœ”[0m[90m should parse simple CSV[0m
    [32m  âœ”[0m[90m should handle quoted fields[0m
    [32m  âœ”[0m[90m should handle quotes with commas inside[0m
    [32m  âœ”[0m[90m should handle escaped quotes (double quotes)[0m
    [32m  âœ”[0m[90m should handle newlines in quoted fields[0m
    [32m  âœ”[0m[90m should handle CRLF line endings[0m
    [32m  âœ”[0m[90m should handle CR line endings[0m
    [32m  âœ”[0m[90m should remove trailing empty rows[0m
    [32m  âœ”[0m[90m should handle empty input[0m
    [32m  âœ”[0m[90m should handle single field[0m
    [32m  âœ”[0m[90m should handle unclosed quotes (invalid CSV)[0m
[0m    toRectangular[0m
    [32m  âœ”[0m[90m should convert rows to rectangular format with headers[0m
    [32m  âœ”[0m[90m should handle empty rows[0m
    [32m  âœ”[0m[90m should skip leading empty rows[0m
    [32m  âœ”[0m[90m should normalize to max column count[0m
    [32m  âœ”[0m[90m should generate default headers for empty header cells[0m
    [32m  âœ”[0m[90m should strip BOM from first header[0m
    [32m  âœ”[0m[90m should handle rows with only empty rows[0m
    [32m  âœ”[0m[90m should handle header-only input[0m
    [32m  âœ”[0m[90m should trim whitespace from headers[0m
[0m    decodeBuffer - SJIS fallback[0m
    [32m  âœ”[0m[90m should fallback to utf8 when iconv-lite decode throws[0m
[0m  encodingNormalizer Test Suite[0m
[0m    normalizeForShiftJisExport[0m
    [31m  26) should return unchanged for ASCII text[0m
    [32m  âœ”[0m[90m should normalize text with NFKC[0m
    [32m  âœ”[0m[90m should return replacement info for changed characters[0m
    [31m  27) should handle empty string[0m
    [32m  âœ”[0m[90m should handle plain Japanese text[0m
[0m    normalizeForImport[0m
    [32m  âœ”[0m[90m should return unchanged for ASCII text[0m
    [32m  âœ”[0m[90m should normalize text with NFKC for import[0m
    [32m  âœ”[0m[90m should return replacement info for changed characters[0m
    [32m  âœ”[0m[90m should handle empty string[0m
[0m  extension Test Suite[0m
  [32m  âœ”[0m[90m should export activate and deactivate functions[0m
[Extension] Applying theme: "inherit"
  [32m  âœ”[0m[90m activate should not throw[0m
[Extension] Broadcasting applyThemeVariables to 0 communication managers
[WebviewManager] broadcastNotification("applyThemeVariables"): No active communication managers
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
  [32m  âœ”[0m[90m deactivate should not throw[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1912)
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
  [32m  âœ”[0m[90m deactivate should handle errors gracefully[0m
Error disposing WebviewManager: Error: getInstance error
	at webviewManager.WebviewManager.getInstance (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/extension.test.js:109:67)
	at Object.deactivate (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/extension.js:46:64)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/extension.test.js:112:21
	at getActual (node:assert:609:5)
	at Object.doesNotThrow (node:assert:777:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/extension.test.js:111:20)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m deactivate should handle WebviewManager.getInstance throwing[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2067)
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1568
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2673
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
  [32m  âœ”[0m[90m deactivate should handle disposeFileHandler throwing[0m
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
Error disposing FileHandler: Error: dispose error
	at fileHandler.disposeFileHandler (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/extension.test.js:135:56)
	at Object.deactivate (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/extension.js:57:9)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/extension.test.js:139:21
	at getActual (node:assert:609:5)
	at Object.doesNotThrow (node:assert:777:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/extension.test.js:138:20)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m deactivate should handle disposeFileHandler function throwing error[0m
[0m  ExtensionCommunicationManager Test Suite[0m
  [32m  âœ”[0m[90m should construct without errors[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendNotification should post a notification message[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendRequest should post a request message and return promise[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendRequest should reject on timeout[0m[33m (55ms)[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendRequest should reject on error response[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m registerHandler should accept and store handler[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m unregisterHandler should remove handler[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m handleIncomingMessage should call registered handler for request[0m[33m (54ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Invalid message format (not an object): null
[ExtComm] Invalid message format (not an object): string
[ExtComm] Invalid protocol message (missing required fields): { type: 'request' }
  [32m  âœ”[0m[90m handleIncomingMessage should ignore invalid messages[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m handleIncomingMessage should handle notification[0m[33m (56ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Received ACK for request: some-request-id
  [32m  âœ”[0m[90m handleIncomingMessage should handle ACK[0m
[ExtComm] Disposing communication manager
[ExtComm] Received error message: {
  id: '1771031963143-haaejz479',
  type: 'error',
  command: 'error',
  data: { error: 'test error' },
  timestamp: 1771031963143
}
  [32m  âœ”[0m[90m handleIncomingMessage should handle ERROR type[0m
[ExtComm] Disposing communication manager
[ExtComm] Unknown message type: UNKNOWN_TYPE
  [32m  âœ”[0m[90m handleIncomingMessage should handle unknown message type[0m
[ExtComm] Disposing communication manager
[ExtComm] Received response for unknown request: non-existent-id
  [32m  âœ”[0m[90m handleIncomingMessage should handle response for unknown request[0m
[ExtComm] Disposing communication manager
[ExtComm] No handler for command: unregisteredCommand
  [32m  âœ”[0m[90m handleRequest should send error response when no handler found[0m[33m (52ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Handler error: Error: Handler failed
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:232:19
	at ExtensionCommunicationManager.handleRequest (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:89:34)
	at ExtensionCommunicationManager.handleIncomingMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:51:32)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:30:18
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:235:19)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m handleRequest should send error response when handler throws[0m[33m (55ms)[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m isWebviewConnected should return boolean[0m
[ExtComm] Disposing communication manager
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m dispose should clear pending requests[0m
[ExtComm] Disposing communication manager
[ExtComm] Disposing communication manager
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m dispose should clear intervals[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m syncState should send notification[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'headers', 'rows' ] }
  [32m  âœ”[0m[90m updateTableData should send notification[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateGitDiff to webview panel: { panelId: 'unknown', hasData: true, keys: [ 'rows' ] }
  [32m  âœ”[0m[90m updateGitDiff should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m setActiveTable should send notification with index[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m applyThemeVariables should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m applyFontSettings should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendOperationSuccess should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendOperationError should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendCellUpdateError should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendHeaderUpdateError should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendAutoSaveStateChanged should send notification[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendDirtyStateChanged should send notification[0m
[ExtComm] Disposing communication manager
[ExtComm] Disposing communication manager
[ExtComm] Failed to post message: Error: Panel disposed
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:341:44)
	at ExtensionCommunicationManager.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:226:32)
	at ExtensionCommunicationManager.sendNotification (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:175:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:350:28
	at getActual (node:assert:609:5)
	at Object.throws (node:assert:757:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:349:16)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m postMessage should throw when webview fails[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m handleNotification should ignore unregistered command[0m[33m (55ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Notification handler error: Error: Notification handler error
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:370:19
	at ExtensionCommunicationManager.handleNotification (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:129:23)
	at ExtensionCommunicationManager.handleIncomingMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:60:32)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:30:18
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:373:19)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m handleNotification should handle handler error[0m[33m (52ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Handler error: string error
  [32m  âœ”[0m[90m handleIncomingMessage should send error for request handler that throws non-Error[0m[33m (56ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'singleTable' ] }
  [32m  âœ”[0m[90m updateTableData should handle non-array data[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateTableData to webview, preview: {
  length: 1,
  sampleKeys: [ 'headers', 'rows', 'gitDiff', 'columnDiff' ]
}
[ExtComm] table 0 has gitDiff: true has columnDiff: false
  [32m  âœ”[0m[90m updateTableData should handle array data with gitDiff[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateGitDiff to webview panel: { panelId: 'unknown', hasData: true, keys: [ 'rows' ] }
  [32m  âœ”[0m[90m updateGitDiff should handle data with details[0m
[ExtComm] Disposing communication manager
[ExtComm] Sync interval triggered
[ExtComm] No messages received for 103 ms
[ExtComm] Sync interval triggered
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m heartbeat and sync intervals should start in constructor[0m[31m (124ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] No messages received for 100031 ms
[ExtComm] No messages received for 100065 ms
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m heartbeat detects disconnection after timeout[0m[31m (83ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
An unknown error occurred. Please consult the log for more details.
  [31m  28) syncInterval fires periodically[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendRequest returns resolved data[0m
[ExtComm] Disposing communication manager
[ExtComm] Received response for unknown request: non-existent-request-id
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
  [31m  29) handleResponse for unknown request logs warning[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'a', 'self' ] }
  [32m  âœ”[0m[90m updateTableData with circular reference does not throw[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateTableData (could not stringify preview)
  [32m  âœ”[0m[90m updateTableData preview catch block when property access throws (L329)[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateGitDiff (could not stringify details)
  [32m  âœ”[0m[90m updateGitDiff preview catch block when property access throws (L346)[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateGitDiff to webview panel: { panelId: 'unknown', hasData: true, keys: [ 'rows', 'self' ] }
  [32m  âœ”[0m[90m updateGitDiff with circular reference does not throw[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'data' ] }
[ExtComm] table 0 has gitDiff: false has columnDiff: false
  [32m  âœ”[0m[90m updateTableData with nested array data[0m
[ExtComm] Disposing communication manager
[ExtComm] Failed to post message: Error: ACK send failed
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:579:31)
	at ExtensionCommunicationManager.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:226:32)
	at ExtensionCommunicationManager.sendAck (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:204:14)
	at ExtensionCommunicationManager.handleRequest (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:81:14)
	at ExtensionCommunicationManager.handleIncomingMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:51:32)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:30:18
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:597:19)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Error handling message: Error: ACK send failed
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:579:31)
	at ExtensionCommunicationManager.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:226:32)
	at ExtensionCommunicationManager.sendAck (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:204:14)
	at ExtensionCommunicationManager.handleRequest (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:81:14)
	at ExtensionCommunicationManager.handleIncomingMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:51:32)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:30:18
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:597:19)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Sync interval triggered
[ExtComm] Disposing communication manager
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m handleIncomingMessage catch block should send error when handler throws and message has id[0m[33m (55ms)[0m
[ExtComm] Disposing communication manager
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendRequest should use default timeout from config[0m[33m (53ms)[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendOperationSuccess with no extra data[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendOperationError with no code[0m
[ExtComm] Disposing communication manager
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m dispose rejects pending requests with dispose message[0m
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendNotification with undefined data[0m
[ExtComm] Disposing communication manager
[ExtComm] Failed to post message: Error: webview disposed
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:664:44)
	at ExtensionCommunicationManager.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:226:32)
	at ExtensionCommunicationManager.sendNotification (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:175:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:670:25
	at getActual (node:assert:609:5)
	at Object.throws (node:assert:757:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:669:16)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m sendNotification rethrows when postMessage fails[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'tables' ] }
[ExtComm] Failed to post message: Error: panel closed
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:678:44)
	at ExtensionCommunicationManager.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:226:32)
	at ExtensionCommunicationManager.sendNotification (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:175:14)
	at ExtensionCommunicationManager.updateTableData (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:331:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:684:25
	at getActual (node:assert:609:5)
	at Object.throws (node:assert:757:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:683:16)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m updateTableData rethrows when postMessage fails[0m
[ExtComm] Disposing communication manager
[ExtComm] Sending updateGitDiff to webview panel: { panelId: 'unknown', hasData: true, keys: [ 'diffs' ] }
[ExtComm] Failed to post message: Error: panel gone
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:691:44)
	at ExtensionCommunicationManager.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:226:32)
	at ExtensionCommunicationManager.sendNotification (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:175:14)
	at ExtensionCommunicationManager.updateGitDiff (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/communication/ExtensionCommunicationManager.js:348:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:697:25
	at getActual (node:assert:609:5)
	at Object.throws (node:assert:757:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/ExtensionCommunicationManager.test.js:696:16)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Disposing communication manager
  [32m  âœ”[0m[90m updateGitDiff rethrows when postMessage fails[0m
[ExtComm] Disposing communication manager
[0m  FileHandler Test Suite[0m
[0m    readMarkdownFile[0m
    [32m  âœ”[0m[90m should read existing file successfully[0m
    [32m  âœ”[0m[90m should throw FileSystemError for non-existent file[0m
    [32m  âœ”[0m[90m should handle empty file[0m
[0m    writeMarkdownFile[0m
    [32m  âœ”[0m[90m should write file successfully[0m
    [32m  âœ”[0m[90m should create directory if it does not exist[0m
    [32m  âœ”[0m[90m should overwrite existing file[0m
[0m    updateTableInFile[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should update table section successfully[0m
    [31m  30) should throw error for invalid line range[0m
[0m    updateMultipleTablesInFile[0m
    [32m  âœ”[0m[90m should update multiple tables successfully[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/multi-table-test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/1792510a/lshH.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/multi-table-test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/1792510a/lshH.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
    [32m  âœ”[0m[90m should handle empty updates array[0m
[ExtComm] Sync interval triggered
    [31m  31) should throw error for invalid line ranges in batch update[0m
[0m    getFileHandler singleton[0m
    [32m  âœ”[0m[90m should return same instance[0m
[0m    FileSystemError[0m
    [32m  âœ”[0m[90m should create error with correct properties[0m
[0m    updateTableByIndex[0m
    [32m  âœ”[0m[90m should update specific table by index in multi-table document[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/update-index-test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/7292cc8a/tzkR.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/update-index-test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/7292cc8a/tzkR.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
    [32m  âœ”[0m[90m should handle invalid table index[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should update first table in multi-table document[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/first-table-update.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-5debbcd6/4KSD.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/first-table-update.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-5debbcd6/4KSD.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
    [32m  âœ”[0m[90m should handle document with mixed content[0m
[0m    readMarkdownFile - open document branch[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/mixed-content-test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/678bd3f7/7bts.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/mixed-content-test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/678bd3f7/7bts.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
    [32m  âœ”[0m[90m should read from open document when available[0m
[0m    readMarkdownFile - generic error wrapping[0m
    [31m  32) should wrap non-FileSystemError into FileSystemError[0m
[0m    writeMarkdownFile - error branches[0m
    [31m  33) should wrap generic write error into FileSystemError[0m
    [32m  âœ”[0m[90m should handle write permission error as FileSystemError[0m
[0m    updateTableByIndex - error branches[0m
    [31m  34) should wrap generic error into FileSystemError[0m
    [32m  âœ”[0m[90m should throw for negative table index[0m
[0m    updateTableInFile - error branches[0m
    [31m  35) should wrap generic error into FileSystemError[0m
[0m    updateMultipleTablesInFile - error branches[0m
    [31m  36) should wrap generic error into FileSystemError[0m
[0m    applyWorkspaceEditAndSave[0m
    [32m  âœ”[0m[90m should apply edit and save successfully[0m
[0m    extractTablePositionsFromTokens[0m
    [32m  âœ”[0m[90m should extract table positions from markdown-it tokens[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/apply-save.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-24ffb70d/HCHH.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/apply-save.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-24ffb70d/HCHH.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
    [32m  âœ”[0m[90m should handle table_close with map[0m
[0m    showErrorNotification[0m
    [31m  37) should handle read operation error notification[0m
[ExtComm] Sync interval triggered
    [31m  38) should handle write operation error notification[0m
    [31m  39) should handle update operation error notification[0m
    [31m  40) should handle default/unknown operation error notification[0m
[0m    notifyFileChange[0m
    [32m  âœ”[0m[90m should handle stat error gracefully[0m
    [32m  âœ”[0m[90m should handle existing file[0m
[0m    withOpenDocument[0m
    [32m  âœ”[0m[90m should call fn with document when file exists[0m
    [31m  41) should wrap non-FileSystemError on open failure[0m
    [32m  âœ”[0m[90m should rethrow FileSystemError unchanged[0m
[0m    handleApplyResult[0m
    [32m  âœ”[0m[90m should log success when applied is true[0m
    [32m  âœ”[0m[90m should log no-change when applied is false[0m
    [32m  âœ”[0m[90m should use default messages when not provided[0m
[0m    getEolString[0m
    [32m  âœ”[0m[90m should return \n for LF documents[0m
[0m    disposeFileHandler[0m
    [32m  âœ”[0m[90m should dispose and reset singleton[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1912)
[0m    normalizeTableLines[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2067)
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1568
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2673
    [32m  âœ”[0m[90m should delegate to fileUtils.normalizeTableLines[0m
[0m    applyWorkspaceEditsForReplacements[0m
    [32m  âœ”[0m[90m should return false for empty replacements[0m
    [32m  âœ”[0m[90m should return false when replacement matches current content[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should apply replacement when content differs[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/diff-rep.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-7752b986/XNQO.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/diff-rep.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-7752b986/XNQO.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
    [32m  âœ”[0m[90m should sort replacements in descending order by startLine[0m
[0m    FileSystemError additional[0m
    [32m  âœ”[0m[90m should create error without originalError[0m
[0m    applyWorkspaceEditAndSave - fallback write[0m
    [32m  âœ”[0m[90m should handle edit apply failure gracefully[0m
[0m    updateMultipleTablesInFile - no changes[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/fallback-save.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-4cd3892d/h3zP.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/markdown-table-editor-test-Uf4Pnj/fallback-save.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-4cd3892d/h3zP.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
    [32m  âœ”[0m[90m should return false when update produces same content[0m
[0m    updateTableInFile - no changes[0m
    [32m  âœ”[0m[90m should return false when table content is unchanged[0m
[0m    notifyFileChange basic[0m
    [32m  âœ”[0m[90m should not throw when notifying file change[0m
[0m    readMarkdownFile - open document in-memory content[0m
    [31m  42) should return getText() from already-open document matching the URI[0m
[0m    readMarkdownFile - non-FileSystemError catch[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should wrap non-FileSystemError from fs.promises.readFile into FileSystemError[0m
[0m    writeMarkdownFile - non-FileSystemError catch[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2067)
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1568
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2673
    [32m  âœ”[0m[90m should wrap non-FileSystemError from fs.promises.writeFile into FileSystemError[0m
[0m    showErrorNotification - all branches[0m
    [32m  âœ”[0m[90m should handle read operation via readMarkdownFile error path[0m
    [32m  âœ”[0m[90m should handle write operation via writeMarkdownFile error path[0m
    [32m  âœ”[0m[90m should handle update operation[0m
    [32m  âœ”[0m[90m should handle default/unknown operation[0m
[0m    applyWorkspaceEditAndSave - save() returns false (fallback)[0m
    [32m  âœ”[0m[90m should fall back to direct fs write when document.save() returns false[0m
[0m    applyWorkspaceEditAndSave - save() throws error[0m
    [32m  âœ”[0m[90m should throw FileSystemError when save() throws[0m
[0m    showErrorNotification - then callback branches[0m
    [32m  âœ”[0m[90m should call outputChannel.show() when user selects Show Details for read error[0m
    [32m  âœ”[0m[90m should call outputChannel.show() when user selects Show Details for write error[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should call showSaveDialog when user selects Save As for write error[0m
    [32m  âœ”[0m[90m should call outputChannel.show() when user selects Show Details for default error[0m
[0m    notifyFileChange - visibleTextEditors[0m
    [31m  43) should log open editors count when file has visible editors[0m
[0m    updateTableByIndex - non-FileSystemError catch[0m
    [32m  âœ”[0m[90m should wrap non-FileSystemError into FileSystemError[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2067)
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1568
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2673
[0m    updateTableInFile - non-FileSystemError catch[0m
    [32m  âœ”[0m[90m should wrap non-FileSystemError into FileSystemError[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2067)
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1568
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2673
[0m    updateMultipleTablesInFile - non-FileSystemError catch[0m
    [32m  âœ”[0m[90m should wrap non-FileSystemError into FileSystemError[0m
[ExtComm] Sync interval triggered
[0m    applyWorkspaceEditAndSave - applyEdit returns false[0m
    [32m  âœ”[0m[90m should throw FileSystemError when applyEdit returns false[0m
[0m    constructor with parser parameter[0m
    [32m  âœ”[0m[90m should use injected parser[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1912)
[0m  fileUtils Test Suite[0m
[0m    normalizeTableLines[0m
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2067)
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1568
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2673
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at c4.o (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2067)
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:1568
Error: Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!
	at yN.add (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:25:1690)
	at file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2673
    [32m  âœ”[0m[90m should split content by newlines[0m
    [32m  âœ”[0m[90m should handle CRLF[0m
    [32m  âœ”[0m[90m should trim trailing empty lines[0m
    [32m  âœ”[0m[90m should keep internal empty lines[0m
    [32m  âœ”[0m[90m should handle single line[0m
    [32m  âœ”[0m[90m should handle empty string[0m
[0m    contentEndsWithLineBreak[0m
    [32m  âœ”[0m[90m should return true for LF ending[0m
    [32m  âœ”[0m[90m should return true for CRLF ending[0m
    [32m  âœ”[0m[90m should return false for no line break[0m
    [32m  âœ”[0m[90m should return false for empty string[0m
    [32m  âœ”[0m[90m should return false for wrong EOL type[0m
[0m    buildUpdatedContent[0m
    [32m  âœ”[0m[90m should replace lines in the middle[0m
    [32m  âœ”[0m[90m should replace first lines[0m
    [32m  âœ”[0m[90m should replace last lines[0m
    [32m  âœ”[0m[90m should throw for invalid start line (negative)[0m
    [32m  âœ”[0m[90m should throw for end line beyond bounds[0m
    [32m  âœ”[0m[90m should throw for start > end[0m
    [32m  âœ”[0m[90m should preserve trailing EOL[0m
    [32m  âœ”[0m[90m should not add trailing EOL when original does not have one[0m
    [32m  âœ”[0m[90m should handle CRLF[0m
    [32m  âœ”[0m[90m should replace single line[0m
    [32m  âœ”[0m[90m should handle replacement with more lines[0m
    [32m  âœ”[0m[90m should handle replacement with fewer lines[0m
    [32m  âœ”[0m[90m should strip trailing EOL when original does not have one[0m
    [32m  âœ”[0m[90m should strip trailing EOL for CRLF when original lacks it[0m
    [32m  âœ”[0m[90m should add trailing EOL when original has it but updated does not[0m
    [32m  âœ”[0m[90m should strip trailing EOL when original lacks it and replacement adds empty trailing line[0m
    [32m  âœ”[0m[90m should strip trailing CRLF when original lacks it (single line)[0m
[0m  logging Test Suite[0m
test message 123
  [31m  44) info should output to console.log[0m
warning message
  [31m  45) warn should output to console.warn[0m
error message
  [31m  46) error should output to console.error[0m
  [32m  âœ”[0m[90m debug should output when MTE_KEEP_CONSOLE is set[0m
debug with keepConsole=1
  [31m  47) debug should output when keepConsole is enabled via fresh require[0m
  [32m  âœ”[0m[90m default export should contain all logging functions[0m
via default
  [31m  48) default export info should work the same as named export[0m
via default warn
  [31m  49) default export warn should work the same as named export[0m
via default error
  [31m  50) default export error should work the same as named export[0m
[0m  MarkdownParser Test Suite[0m
  [32m  âœ”[0m[90m should parse simple table[0m
  [32m  âœ”[0m[90m should parse table[0m
  [32m  âœ”[0m[90m should find multiple tables[0m
  [32m  âœ”[0m[90m should find table at position[0m
  [32m  âœ”[0m[90m should return null for position outside table[0m
  [32m  âœ”[0m[90m should handle empty table[0m
  [32m  âœ”[0m[90m should handle malformed table gracefully[0m
  [32m  âœ”[0m[90m should validate table structure[0m
  [32m  âœ”[0m[90m should detect table structure issues[0m
  [32m  âœ”[0m[90m should find table containing specific line[0m
  [32m  âœ”[0m[90m should get table boundaries accurately[0m
  [32m  âœ”[0m[90m should get enhanced table metadata[0m
  [32m  âœ”[0m[90m should parse multiple tables in document[0m
  [32m  âœ”[0m[90m should handle document with no tables[0m
  [32m  âœ”[0m[90m should handle mixed content with tables[0m
  [32m  âœ”[0m[90m should handle malformed tables gracefully[0m
  [32m  âœ”[0m[90m should handle invalid content in parseDocument[0m
  [32m  âœ”[0m[90m should handle empty content gracefully[0m
  [32m  âœ”[0m[90m should handle invalid AST in findTablesInDocument[0m
  [32m  âœ”[0m[90m should handle malformed table structure gracefully[0m
  [32m  âœ”[0m[90m should handle corrupted token structure[0m
  [32m  âœ”[0m[90m should validate table structure and report issues[0m
  [32m  âœ”[0m[90m should handle table with no headers gracefully[0m
  [32m  âœ”[0m[90m should handle extremely large tables without hanging[0m[33m (70ms)[0m
[ExtComm] Sync interval triggered
[0m  TableManager Test Suite[0m
  [32m  âœ”[0m[90m getAllTables returns all tables[0m
  [32m  âœ”[0m[90m getTableByIndex returns correct table[0m
  [32m  âœ”[0m[90m getTableByIndex returns null for out of range[0m
  [32m  âœ”[0m[90m getTableAtPosition returns table at position[0m
  [32m  âœ”[0m[90m getTableAtPosition returns null outside tables[0m
  [32m  âœ”[0m[90m getTableAtLine returns table containing line[0m
  [32m  âœ”[0m[90m getTableAtLine returns null for line outside tables[0m
  [32m  âœ”[0m[90m getTableCount returns correct count[0m
  [32m  âœ”[0m[90m getTablesWithValidation returns validation for each table[0m
  [32m  âœ”[0m[90m getTablesSummary returns correct summary[0m
  [32m  âœ”[0m[90m getTablesSummary counts invalid tables[0m
  [32m  âœ”[0m[90m refresh updates tables[0m
  [32m  âœ”[0m[90m getTablesInRange returns tables within range[0m
  [32m  âœ”[0m[90m getTablesInRange returns empty for non-matching range[0m
  [32m  âœ”[0m[90m getClosestTable returns closest table[0m
  [32m  âœ”[0m[90m getClosestTable returns null for empty document[0m
  [32m  âœ”[0m[90m getClosestTable picks nearest among multiple[0m
[0m  MarkdownParser extractSeparatorLine[0m
  [32m  âœ”[0m[90m extracts separator from valid table[0m
  [32m  âœ”[0m[90m returns undefined for table without separator[0m
[0m  MarkdownParser getTableMetadata[0m
  [32m  âœ”[0m[90m getTableMetadata returns full metadata[0m
[0m  MarkdownParser Error Classes[0m
  [32m  âœ”[0m[90m should create MarkdownParsingError correctly[0m
  [32m  âœ”[0m[90m should create TableValidationError correctly[0m
[0m  MarkdownParser Additional Coverage[0m
  [32m  âœ”[0m[90m parseDocument should throw for non-string content (number)[0m
  [32m  âœ”[0m[90m parseDocument should throw for boolean content[0m
  [32m  âœ”[0m[90m findTablesInDocument should handle null token inside tokens array[0m
  [32m  âœ”[0m[90m findTablesInDocument should handle token parse error and continue[0m
Table has no headers, skipping
  [32m  âœ”[0m[90m parseTableToken should return null when headers are empty[0m
Table has no headers, skipping
  [32m  âœ”[0m[90m parseTableToken should handle thead_open parse error[0m
  [32m  âœ”[0m[90m parseTableToken should handle tbody_open parse error gracefully[0m
  [32m  âœ”[0m[90m parseTableToken should handle invalid startIndex[0m
  [32m  âœ”[0m[90m parseTableToken should handle null tokens inside parsing loop[0m
Encountered null token at index 1
  [32m  âœ”[0m[90m parseTableToken should update endLine from table_close token with map[0m
Failed to parse table token at index 0: Error: getter error
	at get map (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:779:53)
	at MarkdownParser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:128:35)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:781:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m parseTableToken should handle non-MarkdownParsingError and return null[0m
  [32m  âœ”[0m[90m isTableLine should detect valid table lines[0m
  [32m  âœ”[0m[90m isTableSeparatorLine should detect separator lines[0m
  [32m  âœ”[0m[90m getTableBoundaries should find actual table boundaries[0m
  [32m  âœ”[0m[90m getTableBoundaries should handle table at end of document[0m
  [32m  âœ”[0m[90m extractSeparatorLine should return undefined when second line is not separator[0m
  [32m  âœ”[0m[90m calculateColumnWidth should handle missing columns in rows[0m
Error parsing table head: Error: corrupted token
	at get type (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:849:34)
	at MarkdownParser.extractCellContent (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:285:23)
	at MarkdownParser.parseTableHead (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:229:44)
	at MarkdownParser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:148:49)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:854:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Failed to parse table token at index 0: Error: corrupted token
	at get type (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:849:34)
	at MarkdownParser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:143:27)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:854:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Error parsing table body: Error: corrupted body token
	at get type (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:878:31)
	at MarkdownParser.parseTableBody (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:247:23)
	at MarkdownParser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:161:47)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:883:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m parseTableHead catch block: corrupted thead tokens (L154-156)[0m
  [32m  âœ”[0m[90m parseTableBody catch block: corrupted tbody tokens (L167-169)[0m
  [32m  âœ”[0m[90m tbody_close with non-empty currentRow (L249)[0m
Error parsing table head: TypeError: Cannot read type of corrupted token
	at get type (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:926:34)
	at MarkdownParser.extractCellContent (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:285:23)
	at MarkdownParser.parseTableHead (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:229:44)
	at MarkdownParser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:148:49)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:933:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Failed to parse table token at index 0: TypeError: Cannot read type of corrupted token
	at get type (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:926:34)
	at MarkdownParser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:143:27)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:933:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m parseTableHead catch block: exception inside header cell extraction (L154-156 additional)[0m
Error parsing table body: Error: Corrupted body row token
	at get type (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:953:31)
	at MarkdownParser.parseTableBody (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:247:23)
	at MarkdownParser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:161:47)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:958:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m parseTableBody catch block: exception inside body row extraction (L167-169 additional)[0m
  [32m  âœ”[0m[90m tbody_close with multiple data cells pending in currentRow (L249 additional)[0m
  [32m  âœ”[0m[90m parseDocument should throw when md.parse returns null[0m
  [32m  âœ”[0m[90m parseDocument should wrap non-MarkdownParsingError[0m
  [32m  âœ”[0m[90m findTablesInDocument should warn on invalid table structure but still include it[0m
Error parsing table at token 0: Error: parse table error
	at parser.parseTableToken (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:1028:48)
	at MarkdownParser.findTablesInDocument (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/markdownParser.js:75:48)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/markdownParser.test.js:1033:31)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m findTablesInDocument should continue when parseTableToken throws[0m
  [32m  âœ”[0m[90m findTablesInDocument should wrap non-MarkdownParsingError in outer catch[0m
Table at line 0 has validation issues: [ 'Row 1 has 1 columns, expected 2' ]
  [31m  51) findTablesInDocument should log warning for table with validation issues[0m
[0m  PanelSessionManager Test Suite[0m
  [32m  âœ”[0m[90m should construct without errors[0m
  [32m  âœ”[0m[90m normalizeUri with null returns empty[0m
  [32m  âœ”[0m[90m normalizeUri with undefined returns empty[0m
  [32m  âœ”[0m[90m normalizeUri with empty string returns empty uri[0m
  [32m  âœ”[0m[90m normalizeUri with valid file URI string[0m
  [32m  âœ”[0m[90m normalizeUri with Uri instance[0m
  [32m  âœ”[0m[90m normalizeUri with string containing :: returns null uri[0m
  [32m  âœ”[0m[90m normalizeUri with object having toString[0m
  [32m  âœ”[0m[90m normalizeUri with object having toString returning invalid URI[0m
  [32m  âœ”[0m[90m normalizeUri with number returns empty or null uri[0m
  [32m  âœ”[0m[90m setManagers stores map and primary manager[0m
  [32m  âœ”[0m[90m getManagers returns undefined for unknown key[0m
  [32m  âœ”[0m[90m setManagers with no primary manager at index 0[0m
  [32m  âœ”[0m[90m getPanelAndManagers returns panel and managers[0m
  [32m  âœ”[0m[90m getPanelAndManagers returns null panel for unknown key[0m
  [32m  âœ”[0m[90m resolvePanelContext with null URI returns empty[0m
  [32m  âœ”[0m[90m resolvePanelContext with valid URI but no matching panel[0m
  [32m  âœ”[0m[90m resolvePanelContext with panelId that has matching panel[0m
  [32m  âœ”[0m[90m resolvePanelContext resolves tableManagersMap by panelKey[0m
  [32m  âœ”[0m[90m resolvePanelContext falls back to URI for tableManagersMap[0m
  [32m  âœ”[0m[90m resolvePanelContext with empty panelId uses URI[0m
  [32m  âœ”[0m[90m clearAll removes all managers[0m
  [32m  âœ”[0m[90m clearAll on empty manager does not throw[0m
  [32m  âœ”[0m[90m resolvePanelContext with no panelId falls back to URI key[0m
  [32m  âœ”[0m[90m normalizeUri with Uri having empty scheme[0m
  [32m  âœ”[0m[90m normalizeUri with Uri instance (non-string)[0m
  [31m  52) normalizeUri with Uri instance containing :: returns null[0m
  [31m  53) normalizeUri with object toString returning unparseable[0m
  [32m  âœ”[0m[90m normalizeUri with string that triggers parse error[0m
  [32m  âœ”[0m[90m resolvePanelContext with panelKey falling back to candidateKeys for tableManagersMap[0m
  [32m  âœ”[0m[90m resolvePanelContext falls back tableManagersMap via second candidateKey[0m
[0m  Protocol and Validator Completeness Tests[0m
  [32m  âœ”[0m[90m All WebviewCommand enum values should be in validCommands array[0m
  [32m  âœ”[0m[90m validCommands should not contain undefined or duplicate entries[0m
  [32m  âœ”[0m[90m importCSV command should be recognized as valid[0m
  [32m  âœ”[0m[90m importCSV command should validate correctly with tableIndex[0m
  [32m  âœ”[0m[90m importCSV command should validate correctly without data[0m
  [32m  âœ”[0m[90m importCSV command should validate correctly with empty object[0m
  [32m  âœ”[0m[90m All protocol commands should have validation logic[0m
  [32m  âœ”[0m[90m Validator should reject invalid importCSV data[0m
  [32m  âœ”[0m[90m validateMessageData should return false for unknown command (default branch)[0m
  [32m  âœ”[0m[90m validateMessageData should return false for requestSync (default branch)[0m
  [32m  âœ”[0m[90m validateMessageData should return false for stateUpdate (default branch)[0m
  [32m  âœ”[0m[90m validateMessageData addRow with undefined data should pass[0m
  [32m  âœ”[0m[90m validateMessageData addColumn with undefined data should pass[0m
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m validateMessageData moveRow with fromIndex should pass[0m
  [32m  âœ”[0m[90m validateMessageData moveColumn without indices or fromIndex should fail[0m
  [32m  âœ”[0m[90m validateMessageData exportCSV with empty csvContent should fail[0m
  [32m  âœ”[0m[90m validateMessageData exportCSV with empty filename should fail[0m
  [32m  âœ”[0m[90m validateMessageData switchTable with negative index should fail[0m
  [32m  âœ”[0m[90m validateMessageData should pass through manualSave command[0m
  [32m  âœ”[0m[90m validateMessageData should pass through toggleAutoSave command[0m
  [32m  âœ”[0m[90m validateMessageData should return false for completely unknown command[0m
  [32m  âœ”[0m[90m validateMessageData exportCSV with valid filename should pass[0m
  [32m  âœ”[0m[90m validateMessageData updateCell with negative row should fail[0m
  [32m  âœ”[0m[90m validateMessageData deleteRows with negative index should fail[0m
  [32m  âœ”[0m[90m validateMessageData sort with invalid direction should fail[0m
[0m  TableDataManager Test Suite[0m
  [32m  âœ”[0m[90m should load table from TableNode[0m
  [32m  âœ”[0m[90m should update cell value[0m
  [32m  âœ”[0m[90m should throw error for invalid cell position[0m
  [32m  âœ”[0m[90m should add row at end[0m
  [32m  âœ”[0m[90m should add row at specific index[0m
  [32m  âœ”[0m[90m should delete row[0m
  [32m  âœ”[0m[90m should throw error for invalid row index[0m
  [32m  âœ”[0m[90m should add column at end[0m
  [32m  âœ”[0m[90m should add column at specific index[0m
  [32m  âœ”[0m[90m should delete column[0m
  [32m  âœ”[0m[90m should not delete last column[0m
  [32m  âœ”[0m[90m should sort by column ascending[0m
  [32m  âœ”[0m[90m should sort by column descending[0m
  [32m  âœ”[0m[90m should move row[0m
  [32m  âœ”[0m[90m should move column[0m
  [32m  âœ”[0m[90m should serialize to markdown[0m
  [32m  âœ”[0m[90m should escape pipe characters when serializing to markdown[0m
  [32m  âœ”[0m[90m should not double-escape already escaped pipes[0m
  [32m  âœ”[0m[90m should validate table structure[0m
  [32m  âœ”[0m[90m should detect validation issues[0m
  [32m  âœ”[0m[90m should provide table statistics[0m
  [32m  âœ”[0m[90m should handle change listeners[0m
  [32m  âœ”[0m[90m should clone table data manager[0m
  [32m  âœ”[0m[90m should generate unique table IDs[0m
  [32m  âœ”[0m[90m should batch update multiple cells[0m
  [32m  âœ”[0m[90m should insert multiple rows[0m
  [32m  âœ”[0m[90m should delete multiple rows[0m
  [32m  âœ”[0m[90m should insert multiple columns[0m
  [32m  âœ”[0m[90m should delete multiple columns[0m
  [32m  âœ”[0m[90m should update entire row[0m
  [32m  âœ”[0m[90m should update entire column[0m
  [32m  âœ”[0m[90m should clear all cells[0m
  [32m  âœ”[0m[90m should clear specific row[0m
  [32m  âœ”[0m[90m should clear specific column[0m
  [32m  âœ”[0m[90m should duplicate row[0m
  [32m  âœ”[0m[90m should duplicate column[0m
  [32m  âœ”[0m[90m should find and replace text[0m
  [32m  âœ”[0m[90m should find and replace with regex[0m
  [32m  âœ”[0m[90m should get row data[0m
  [32m  âœ”[0m[90m should get column data[0m
  [32m  âœ”[0m[90m should get cell value[0m
  [32m  âœ”[0m[90m should check if table is empty[0m
  [32m  âœ”[0m[90m should detect empty cells[0m
  [32m  âœ”[0m[90m should handle batch update errors[0m
  [32m  âœ”[0m[90m should handle column deletion constraints[0m
  [32m  âœ”[0m[90m should perform advanced sort with options[0m
  [32m  âœ”[0m[90m should perform multi-column sort[0m
  [32m  âœ”[0m[90m should sort with custom function[0m
  [32m  âœ”[0m[90m should shuffle rows randomly[0m
  [32m  âœ”[0m[90m should reverse row order[0m
  [32m  âœ”[0m[90m should detect column data types[0m
  [32m  âœ”[0m[90m should perform natural sort[0m
  [32m  âœ”[0m[90m should get sort indicators[0m
  [32m  âœ”[0m[90m should get column statistics[0m
  [32m  âœ”[0m[90m should clear sort state[0m
  [32m  âœ”[0m[90m should handle case-insensitive sorting[0m
  [32m  âœ”[0m[90m should handle date sorting[0m
  [32m  âœ”[0m[90m should move row via drag and drop - forward movement[0m
  [32m  âœ”[0m[90m should move row via drag and drop - backward movement[0m
  [32m  âœ”[0m[90m should move row to middle position[0m
  [32m  âœ”[0m[90m should move multiple rows preserving order[0m
  [32m  âœ”[0m[90m should move column via drag and drop - forward movement[0m
  [32m  âœ”[0m[90m should move column via drag and drop - backward movement[0m
  [32m  âœ”[0m[90m should move multiple columns preserving order and separator line[0m
  [32m  âœ”[0m[90m should move column to middle position[0m
  [32m  âœ”[0m[90m should handle invalid row move indices[0m
  [32m  âœ”[0m[90m should handle invalid column move indices[0m
  [32m  âœ”[0m[90m should handle same position moves (no-op)[0m
  [32m  âœ”[0m[90m should preserve data integrity during multiple drag operations[0m
  [32m  âœ”[0m[90m should trigger change listeners during drag operations[0m
  [32m  âœ”[0m[90m should update metadata during drag operations[0m
  [32m  âœ”[0m[90m should serialize correctly after complex drag operations[0m
  [32m  âœ”[0m[90m should handle drag operations on single row table[0m
  [32m  âœ”[0m[90m should handle drag operations on single column table[0m
  [32m  âœ”[0m[90m should start row drag operation - Requirement 4.1[0m
  [32m  âœ”[0m[90m should start column drag operation - Requirement 4.2[0m
  [32m  âœ”[0m[90m should provide visual feedback during drag - Requirement 4.3[0m
  [32m  âœ”[0m[90m should complete drag and drop and update Markdown - Requirement 4.4[0m
  [32m  âœ”[0m[90m should cancel drag operation[0m
  [32m  âœ”[0m[90m should validate drop zones correctly[0m
  [32m  âœ”[0m[90m should create drag preview correctly[0m
  [32m  âœ”[0m[90m should handle invalid drag operations gracefully[0m
  [32m  âœ”[0m[90m should handle drag to invalid drop zone[0m
  [32m  âœ”[0m[90m should maintain data integrity during complex drag operations[0m
  [32m  âœ”[0m[90m should create manager with table index[0m
  [32m  âœ”[0m[90m should default table index to 0 when not specified[0m
  [32m  âœ”[0m[90m should preserve table index through operations[0m
  [32m  âœ”[0m[90m should handle multi-table scenario metadata[0m
  [32m  âœ”[0m[90m should handle line break tags in cell content[0m
  [32m  âœ”[0m[90m should preserve cell formatting during updates[0m
  [32m  âœ”[0m[90m should maintain table structure after cell edits[0m
  [32m  âœ”[0m[90m should handle cell editing and wrapping[0m
  [32m  âœ”[0m[90m should handle empty cell values correctly[0m
  [32m  âœ”[0m[90m getRow should throw for invalid index[0m
  [32m  âœ”[0m[90m getColumn should throw for invalid index[0m
  [32m  âœ”[0m[90m getCell should throw for invalid position[0m
  [32m  âœ”[0m[90m hasEmptyCells should return false when no empty cells[0m
  [32m  âœ”[0m[90m getEmptyCells should return empty array when no empty cells[0m
  [32m  âœ”[0m[90m sortByColumnAdvanced should throw for invalid column[0m
  [32m  âœ”[0m[90m sortByColumnAdvanced with custom comparator[0m
  [32m  âœ”[0m[90m sortByMultipleColumns should return early for empty criteria[0m
  [32m  âœ”[0m[90m sortByMultipleColumns should throw for invalid column[0m
  [32m  âœ”[0m[90m reverseRows should flip sort direction[0m
  [32m  âœ”[0m[90m reverseRows with no sort state[0m
  [32m  âœ”[0m[90m sortNatural should throw for invalid column[0m
  [32m  âœ”[0m[90m sortNatural descending order[0m
  [32m  âœ”[0m[90m getSortIndicators when no sort state[0m
  [32m  âœ”[0m[90m getSortedColumnStats should throw for invalid column[0m
  [32m  âœ”[0m[90m getSortedColumnStats for date column[0m
  [32m  âœ”[0m[90m getSortedColumnStats for string column[0m
  [32m  âœ”[0m[90m getSortedColumnStats with empty values[0m
  [32m  âœ”[0m[90m validateRowMove returns valid for correct indices[0m
  [32m  âœ”[0m[90m validateRowMove returns invalid for bad from index[0m
  [32m  âœ”[0m[90m validateRowMove returns invalid for bad to index[0m
  [32m  âœ”[0m[90m validateRowMove returns invalid for same indices[0m
  [32m  âœ”[0m[90m validateColumnMove returns valid for correct indices[0m
  [32m  âœ”[0m[90m validateColumnMove returns invalid for bad from index[0m
  [32m  âœ”[0m[90m validateColumnMove returns invalid for bad to index[0m
  [32m  âœ”[0m[90m validateColumnMove returns invalid for same indices[0m
  [32m  âœ”[0m[90m moveRowSafe succeeds for valid indices[0m
  [32m  âœ”[0m[90m moveRowSafe fails for invalid indices[0m
  [32m  âœ”[0m[90m moveColumnSafe succeeds for valid indices[0m
  [32m  âœ”[0m[90m moveColumnSafe fails for invalid indices[0m
  [32m  âœ”[0m[90m searchReplace with includeHeaders[0m
  [32m  âœ”[0m[90m searchReplace no match returns 0[0m
  [32m  âœ”[0m[90m updateCell should initialize editedCells when undefined[0m
  [32m  âœ”[0m[90m updateHeader should update header value and track edit[0m
  [32m  âœ”[0m[90m updateHeader should throw for negative column index[0m
  [32m  âœ”[0m[90m updateHeader should throw for out-of-range column index[0m
  [32m  âœ”[0m[90m updateHeader should initialize editedCells when undefined[0m
  [32m  âœ”[0m[90m addRow should throw for negative index[0m
  [32m  âœ”[0m[90m addRow should throw for index beyond length[0m
  [32m  âœ”[0m[90m addRow should throw for count < 1[0m
  [32m  âœ”[0m[90m addRow should add multiple rows at once[0m
  [32m  âœ”[0m[90m addColumn should throw for negative index[0m
  [32m  âœ”[0m[90m addColumn should throw for index beyond length[0m
  [32m  âœ”[0m[90m addColumn should throw for count <= 0[0m
  [32m  âœ”[0m[90m addColumn with count > 1 should add multiple columns[0m
  [32m  âœ”[0m[90m addColumn without index should append[0m
  [32m  âœ”[0m[90m addColumn with defaultName should use it for all added columns[0m
  [32m  âœ”[0m[90m deleteColumn should throw for negative index[0m
  [32m  âœ”[0m[90m deleteColumn should throw for out-of-range index[0m
  [32m  âœ”[0m[90m sortByColumn should throw for invalid column index[0m
  [32m  âœ”[0m[90m sortByColumn should sort strings using localeCompare[0m
  [32m  âœ”[0m[90m moveRows with empty indices should be a no-op[0m
  [32m  âœ”[0m[90m moveRows with all invalid indices should be a no-op[0m
  [32m  âœ”[0m[90m moveRows should throw for invalid dropIndex[0m
  [32m  âœ”[0m[90m moveRows should handle duplicate indices[0m
  [32m  âœ”[0m[90m moveRows should move multiple rows to end[0m
  [32m  âœ”[0m[90m moveColumns with empty indices should be a no-op[0m
  [32m  âœ”[0m[90m moveColumns with all invalid indices should be a no-op[0m
  [32m  âœ”[0m[90m moveColumns should throw for invalid dropIndex[0m
  [32m  âœ”[0m[90m moveColumns should move multiple columns to start[0m
  [32m  âœ”[0m[90m serializeToMarkdown should return rawLines as-is when no edits[0m
  [32m  âœ”[0m[90m serializeToMarkdown should generate from scratch when no rawLines[0m
  [32m  âœ”[0m[90m serializeToMarkdown should do differential update for rawLines with edits[0m
  [32m  âœ”[0m[90m serializeToMarkdown differential update should handle header edits[0m
  [32m  âœ”[0m[90m serializeToMarkdown with rawLines having escaped pipes uses differential update[0m
  [32m  âœ”[0m[90m splitLineByUnescapedPipe returns null for line with fewer than 2 pipes[0m
  [32m  âœ”[0m[90m splitLineByUnescapedPipe skips escaped pipes[0m
  [32m  âœ”[0m[90m splitLineByUnescapedPipe parses correctly with escaped pipes[0m
  [32m  âœ”[0m[90m addColumn with separator line should update separator[0m
  [32m  âœ”[0m[90m deleteColumn with separator line should update separator[0m
  [32m  âœ”[0m[90m separator update with invalid format should clear separator[0m
  [32m  âœ”[0m[90m separator update without separator line should be no-op[0m
  [32m  âœ”[0m[90m moveColumn with invalid separator format should clear separator[0m
  [32m  âœ”[0m[90m moveColumn with valid separator line should update separator[0m
  [32m  âœ”[0m[90m moveColumn without separator line should be no-op for separator[0m
  [32m  âœ”[0m[90m moveColumns with invalid separator format should clear separator[0m
  [32m  âœ”[0m[90m moveColumns with valid separator should reorder separator parts[0m
  [32m  âœ”[0m[90m moveColumns without separator should be no-op for separator[0m
  [32m  âœ”[0m[90m batchUpdateCells should update header when row is -1[0m
  [32m  âœ”[0m[90m batchUpdateCells should throw for invalid column in header update[0m
  [32m  âœ”[0m[90m batchUpdateCells should initialize editedCells when undefined[0m
  [32m  âœ”[0m[90m replaceContents should replace entire table contents[0m
  [32m  âœ”[0m[90m replaceContents should throw for empty headers[0m
  [32m  âœ”[0m[90m replaceContents should throw for row length mismatch[0m
  [32m  âœ”[0m[90m replaceContents should throw for non-array rows[0m
  [32m  âœ”[0m[90m insertRows should throw for negative startIndex[0m
  [32m  âœ”[0m[90m insertRows should throw for startIndex beyond length[0m
  [32m  âœ”[0m[90m insertRows should throw for count <= 0[0m
  [32m  âœ”[0m[90m deleteRows should throw for invalid index[0m
  [32m  âœ”[0m[90m deleteRows should delete in descending order to preserve indices[0m
  [32m  âœ”[0m[90m insertColumns should throw for negative startIndex[0m
  [32m  âœ”[0m[90m insertColumns should throw for startIndex beyond header length[0m
  [32m  âœ”[0m[90m insertColumns should throw for count <= 0[0m
  [32m  âœ”[0m[90m insertColumns should throw for header count mismatch[0m
  [32m  âœ”[0m[90m insertColumns should generate default headers when not provided[0m
  [32m  âœ”[0m[90m deleteColumns should throw for invalid column index[0m
  [32m  âœ”[0m[90m updateRow should throw for invalid row index[0m
  [32m  âœ”[0m[90m updateRow should throw for column count mismatch[0m
  [32m  âœ”[0m[90m updateColumn should throw for invalid column index[0m
  [32m  âœ”[0m[90m updateColumn should throw for row count mismatch[0m
  [32m  âœ”[0m[90m updateColumn without newHeader should keep existing header[0m
  [32m  âœ”[0m[90m clearRow should throw for invalid row index[0m
  [32m  âœ”[0m[90m clearColumn should throw for invalid column index[0m
  [32m  âœ”[0m[90m duplicateRow with custom insertIndex should insert at specified position[0m
  [32m  âœ”[0m[90m duplicateRow should throw for invalid row index[0m
  [32m  âœ”[0m[90m duplicateColumn with custom insertIndex should insert at specified position[0m
  [32m  âœ”[0m[90m duplicateColumn should throw for invalid column index[0m
  [32m  âœ”[0m[90m findAndReplace case-sensitive should not match different case[0m
  [32m  âœ”[0m[90m findAndReplace case-sensitive should match exact case[0m
  [32m  âœ”[0m[90m findAndReplace wholeWord should not match partial words[0m
  [32m  âœ”[0m[90m findAndReplace with regex and caseSensitive[0m
  [32m  âœ”[0m[90m completeDragDrop should work with column drag[0m
  [32m  âœ”[0m[90m removeDragDropListener should remove listener[0m
  [32m  âœ”[0m[90m removeDragDropListener with non-existing listener should be no-op[0m
  [32m  âœ”[0m[90m cancelDragDrop when not dragging should be no-op[0m
  [32m  âœ”[0m[90m updateDragPosition when not dragging should return false[0m
  [32m  âœ”[0m[90m createDragPreview should generate preview for column drag[0m
  [32m  âœ”[0m[90m serializeToMarkdown should use original separator line when available[0m
  [32m  âœ”[0m[90m deleteColumns with separator line should update separator correctly[0m
  [32m  âœ”[0m[90m sortByColumn with mixed data uses string fallback[0m
  [32m  âœ”[0m[90m sortByColumn descending with strings should reverse string order[0m
  [32m  âœ”[0m[90m moveRow should throw when from is out of range[0m
  [32m  âœ”[0m[90m moveRow should throw when to is out of range[0m
  [32m  âœ”[0m[90m moveColumn should throw when from is out of range[0m
  [32m  âœ”[0m[90m moveColumn should throw when to is out of range[0m
  [32m  âœ”[0m[90m detectColumnDataType returns string for out-of-range index[0m
  [32m  âœ”[0m[90m detectColumnDataType returns string for empty values[0m
  [32m  âœ”[0m[90m compareValues with number type[0m
  [32m  âœ”[0m[90m compareValues with date type[0m
  [32m  âœ”[0m[90m compareValues with string case-insensitive[0m
  [32m  âœ”[0m[90m compareValues with string case-sensitive[0m
  [32m  âœ”[0m[90m escapePipeCharacters returns empty string for empty input[0m
  [32m  âœ”[0m[90m escapePipeCharacters returns empty string for null-like input[0m
  [32m  âœ”[0m[90m updateTableLine fallback path when splitLineByUnescapedPipe returns null[0m
  [32m  âœ”[0m[90m updateTableLine with normal pipe-formatted line[0m
  [32m  âœ”[0m[90m naturalCompare with same alpha part sorts by number[0m
  [32m  âœ”[0m[90m naturalCompare with same alpha and same number returns 0[0m
  [32m  âœ”[0m[90m naturalCompare with different alpha part sorts alphabetically[0m
  [32m  âœ”[0m[90m startRowDrag should throw for invalid index[0m
  [32m  âœ”[0m[90m startColumnDrag should throw for invalid index[0m
  [32m  âœ”[0m[90m getValidRowDropZones should exclude drag index and adjacent[0m
  [32m  âœ”[0m[90m getValidColumnDropZones should exclude drag index and adjacent[0m
  [32m  âœ”[0m[90m isValidDropZone should return false when no drag is active[0m
  [32m  âœ”[0m[90m deleteColumn should prevent deleting the sole remaining column[0m
  [32m  âœ”[0m[90m loadTable should preserve rawLines from TableNode[0m
  [32m  âœ”[0m[90m addRow should invalidate rawLines[0m
  [32m  âœ”[0m[90m deleteRow should invalidate rawLines[0m
  [32m  âœ”[0m[90m moveRow should invalidate rawLines[0m
  [32m  âœ”[0m[90m validateTableStructure should detect empty headers[0m
  [32m  âœ”[0m[90m validateTableStructure should warn about empty header names[0m
  [32m  âœ”[0m[90m updateTableLine preserves spacing for unedited cells when editedCols not provided[0m
  [32m  âœ”[0m[90m serializeToMarkdown with multiple cell edits on rawLines[0m
  [32m  âœ”[0m[90m sortByColumnAdvanced with auto dataType should detect and sort[0m
  [32m  âœ”[0m[90m sortByMultipleColumns with explicit dataType should use it[0m
  [32m  âœ”[0m[90m completeDragDrop to invalid zone should cancel and return false[0m
  [32m  âœ”[0m[90m createDragPreview does nothing when not dragging[0m
  [32m  âœ”[0m[90m updateTableLine fallback covers edited and unedited cells and extra columns[0m
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m serializeToMarkdown preserves trailing content after last pipe[0m
  [32m  âœ”[0m[90m getStatistics should count empty cells correctly[0m
  [32m  âœ”[0m[90m sortByMultipleColumns should return non-zero comparison immediately[0m
  [32m  âœ”[0m[90m serializeToMarkdown skips malformed editedCells keys[0m
  [32m  âœ”[0m[90m updateTableLine handles extra original cells beyond newValues[0m
  [32m  âœ”[0m[90m updateTableLine fallback path with mix of edited and unedited cells[0m
  [32m  âœ”[0m[90m updateTableLine fallback path with escaped pipes triggers full fallback logic[0m
  [32m  âœ”[0m[90m updateTableLine fallback path: edited cell, unedited cell, and extra cell[0m
  [32m  âœ”[0m[90m updateTableLine fallback with 3-pipe line where parser returns null due to escaping[0m
  [32m  âœ”[0m[90m updateTableLine fallback exercises edited, unedited, and extra cell branches[0m
  [32m  âœ”[0m[90m sortByMultipleColumns returns early when primary comparison is non-zero[0m
  [32m  âœ”[0m[90m sortByMultipleColumns returns 0 when all criteria are equal[0m
  [32m  âœ”[0m[90m sortByMultipleColumns desc direction applies negation correctly[0m
  [32m  âœ”[0m[90m completeDragDrop catch block triggers when internal move throws[0m
  [32m  âœ”[0m[90m moveRowSafe catch block handles unexpected errors[0m
  [32m  âœ”[0m[90m moveColumnSafe catch block handles unexpected errors[0m
[0m  TableEditRunner Test Suite[0m
  [32m  âœ”[0m[90m should construct without errors[0m
  [32m  âœ”[0m[90m run should return early when uri is undefined[0m
  [32m  âœ”[0m[90m run should return early when panel is null[0m
  [32m  âœ”[0m[90m run should send error when tableManagersMap is null[0m
  [32m  âœ”[0m[90m run should send error when tableDataManager is not found[0m
  [32m  âœ”[0m[90m run should execute mutate and send success with auto save enabled[0m
  [32m  âœ”[0m[90m run should set dirty state when auto save is disabled[0m
  [32m  âœ”[0m[90m run should send error when mutate throws[0m
  [32m  âœ”[0m[90m run should use default error message when getErrorMessage is not provided[0m
  [32m  âœ”[0m[90m run should use default success message when getSuccessMessage is not provided[0m
  [32m  âœ”[0m[90m run should use custom undo description when provided[0m
  [32m  âœ”[0m[90m run should handle null successMessage (no message sent)[0m
  [32m  âœ”[0m[90m run should handle non-Error throw correctly[0m
  [32m  âœ”[0m[90m run should silently catch sendOperationSuccess (save-started) error[0m
  [32m  âœ”[0m[90m run should handle applied === false path[0m
  [32m  âœ”[0m[90m run should silently catch sendOperationSuccess (save-completed) error[0m
  [32m  âœ”[0m[90m run should silently catch sendOperationSuccess error when auto save is OFF[0m
  [32m  âœ”[0m[90m run should use panelId for actualPanelId when provided[0m
  [32m  âœ”[0m[90m run should handle gitDiffCoordinator.scheduleGitDiffCalculation rejection silently[0m
[0m  ThemeApplier Test Suite[0m
  [32m  âœ”[0m[90m should construct without errors[0m
  [31m  54) "after each" hook for "should construct without errors"[0m
[0m  themeUtils Test Suite[0m
[0m    getInstalledColorThemes[0m
    [32m  âœ”[0m[90m should return an array[0m
    [31m  55) "after each" hook for "should return an array"[0m
[0m  UI/UX Enhancement Tests[0m
Extension not found in test environment - this is expected in some test configurations
  [32m  âœ”[0m[90m Extension should be present[0m
Extension for commands test found: false
Available commands containing "markdownTableEditor": [
  'markdownTableEditor.openEditor',
  'markdownTableEditor.openEditorNewPanel',
  'markdownTableEditor.selectTheme',
  'markdownTableEditor.internal.requestTableData',
  'markdownTableEditor.internal.updateCell',
  'markdownTableEditor.internal.bulkUpdateCells',
  'markdownTableEditor.internal.updateHeader',
  'markdownTableEditor.internal.addRow',
  'markdownTableEditor.internal.deleteRow',
  'markdownTableEditor.internal.addColumn',
  'markdownTableEditor.internal.deleteColumn',
  'markdownTableEditor.internal.deleteRows',
  'markdownTableEditor.internal.deleteColumns',
  'markdownTableEditor.internal.sort',
  'markdownTableEditor.internal.moveRow',
  'markdownTableEditor.internal.moveColumn',
  'markdownTableEditor.internal.exportCSV',
  'markdownTableEditor.internal.importCSV',
  'markdownTableEditor.internal.forceFileSave'
]
Extension not found in test environment - skipping command registration test
  [32m  âœ”[0m[90m Commands should be registered[0m
[ExtComm] Sync interval triggered
Error opening table editor: Error: Channel has been closed
	at r (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2616)
	at Object.appendLine (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2755)
	at MarkdownFileHandler.readMarkdownFile (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/fileHandler.js:76:32)
	at CommandRegistrar.handleOpenEditor (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:187:52)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:33:24
	at CA.h (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:41751)
	at CA.g (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40828)
	at CA.executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40735)
	at executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:213:104946)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:297:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/uiux.test.js:89:35)
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m Should handle webview status messages[0m[31m (2019ms)[0m
Error opening table editor: Error: Channel has been closed
	at r (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2616)
	at Object.appendLine (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2755)
	at MarkdownFileHandler.readMarkdownFile (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/fileHandler.js:76:32)
	at CommandRegistrar.handleOpenEditor (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:187:52)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:33:24
	at CA.h (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:41751)
	at CA.g (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40828)
	at CA.executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40735)
	at executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:213:104946)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:297:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/uiux.test.js:111:35)
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m Should handle cell editing focus management[0m[31m (2006ms)[0m
Error opening table editor: Error: Channel has been closed
	at r (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2616)
	at Object.appendLine (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2755)
	at MarkdownFileHandler.readMarkdownFile (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/fileHandler.js:76:32)
	at CommandRegistrar.handleOpenEditor (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:187:52)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:33:24
	at CA.h (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:41751)
	at CA.g (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40828)
	at CA.executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40735)
	at executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:213:104946)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:297:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/uiux.test.js:131:35)
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m Should support simplified toolbar interface[0m[31m (2004ms)[0m
[ExtComm] Sync interval triggered
Error opening table editor: Error: Channel has been closed
	at r (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2616)
	at Object.appendLine (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2755)
	at MarkdownFileHandler.readMarkdownFile (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/fileHandler.js:76:32)
	at CommandRegistrar.handleOpenEditor (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:187:52)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:33:24
	at CA.h (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:41751)
	at CA.g (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40828)
	at CA.executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40735)
	at executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:213:104946)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:297:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/uiux.test.js:154:35)
  [32m  âœ”[0m[90m Should handle error messages in status bar[0m
Error opening table editor: Error: Channel has been closed
	at r (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2616)
	at Object.appendLine (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:123:2755)
	at MarkdownFileHandler.readMarkdownFile (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/fileHandler.js:76:32)
	at CommandRegistrar.handleOpenEditor (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:187:52)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/activation/commandRegistrar.js:33:24
	at CA.h (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:41751)
	at CA.g (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40828)
	at CA.executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:40735)
	at executeCommand (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:213:104946)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:191:24)
	at vscode.commands.executeCommand (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/csv-export-interface.test.js:297:24)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/uiux.test.js:171:35)
  [32m  âœ”[0m[90m Should support context menu operations without toolbar buttons[0m
[0m  UndoRedoManager Test Suite[0m
  [32m  âœ”[0m[90m getInstance should return singleton[0m
  [32m  âœ”[0m[90m canUndo should return false initially[0m
  [32m  âœ”[0m[90m canRedo should return false initially[0m
  [32m  âœ”[0m[90m getStats should return zero counts initially[0m
  [32m  âœ”[0m[90m saveState should add to undo stack[0m
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m saveState should clear redo stack[0m
  [32m  âœ”[0m[90m saveState should limit stack size to maxStackSize[0m
[MTE][UndoRedo] Failed to save state: CodeExpectedError: cannot open file:///var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/undo-redo-test-aMBuSQ/non-existent.md. Detail: Unable to read file '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/undo-redo-test-aMBuSQ/non-existent.md' (Error: Unable to resolve nonexistent file '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/undo-redo-test-aMBuSQ/non-existent.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
  [32m  âœ”[0m[90m saveState should handle errors gracefully[0m
  [32m  âœ”[0m[90m undo should return false when stack is empty[0m
  [32m  âœ”[0m[90m undo should restore previous state[0m
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m undo should add current state to redo stack[0m
  [32m  âœ”[0m[90m redo should return false when stack is empty[0m
  [32m  âœ”[0m[90m redo should restore undone state[0m
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m redo should add current state to undo stack[0m
  [32m  âœ”[0m[90m clearHistory should reset both stacks[0m
  [32m  âœ”[0m[90m multiple undos should work sequentially[0m
  [32m  âœ”[0m[90m getStats should reflect undo/redo counts correctly[0m
Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/undo-redo-test-rvEoDC/test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-54bf3382/0RoN.md': EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, copyfile '/var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/undo-redo-test-rvEoDC/test.md' -> '/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/user-data/User/History/-54bf3382/0RoN.md'
    at k6.create (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:29866)
    at ls (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:38:27043)
    at Qc.jb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22568)
    at Qc.gb (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/main.js:63:22011)
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m separate URIs should have independent stacks[0m
  [32m  âœ”[0m[90m saveState stack.shift() fires when exceeding maxStackSize[0m
[MTE][UndoRedo] Failed to save state: Error: Cannot open document
	at vscode.workspace.openTextDocument (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:188:19)
	at UndoRedoManager.saveState (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/undoRedoManager.js:28:53)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:192:27)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at cbHookRun (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:550:7)
	at done (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:308:5)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:387:7)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:509:10)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m saveState catch block when openTextDocument throws (L51 JS)[0m
  [32m  âœ”[0m[90m undo should create redo stack if not exists and succeed[0m
[MTE][UndoRedo] Undo failed to apply: Error: apply failed
	at Object.applyWorkspaceEditAndSave (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:221:60)
	at UndoRedoManager.undo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/undoRedoManager.js:79:59)
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:225:28)
  [32m  âœ”[0m[90m undo should restore undo stack when applyWorkspaceEditAndSave fails[0m
[MTE][UndoRedo] Undo operation failed: TypeError: Cannot read properties of null (reading 'content')
	at UndoRedoManager.undo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/undoRedoManager.js:77:56)
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:245:24)
  [32m  âœ”[0m[90m undo should return false when outer try/catch fires (e.g., openTextDocument fails)[0m
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m redo should create undo stack if not exists and succeed[0m
[MTE][UndoRedo] Redo failed to apply: Error: redo apply failed
	at Object.applyWorkspaceEditAndSave (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:272:60)
	at UndoRedoManager.redo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/undoRedoManager.js:126:59)
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:276:28)
  [32m  âœ”[0m[90m redo should restore redo stack when applyWorkspaceEditAndSave fails[0m
[MTE][UndoRedo] Redo operation failed: TypeError: Cannot read properties of null (reading 'content')
	at UndoRedoManager.redo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/undoRedoManager.js:124:52)
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/undoRedoManager.test.js:295:24)
  [32m  âœ”[0m[90m redo should return false when outer try/catch fires[0m
[0m  validators Test Suite[0m
[0m    isObject[0m
    [32m  âœ”[0m[90m should return true for plain object[0m
    [32m  âœ”[0m[90m should return false for null[0m
    [32m  âœ”[0m[90m should return false for undefined[0m
    [32m  âœ”[0m[90m should return false for string[0m
    [32m  âœ”[0m[90m should return false for number[0m
    [32m  âœ”[0m[90m should return true for array[0m
[0m    validateBasicMessageStructure[0m
    [32m  âœ”[0m[90m should return true for valid message[0m
    [32m  âœ”[0m[90m should return false for null[0m
    [32m  âœ”[0m[90m should return false for non-object[0m
    [32m  âœ”[0m[90m should return false for missing command[0m
    [32m  âœ”[0m[90m should return false for non-string command[0m
[0m    validateMessageCommand[0m
    [32m  âœ”[0m[90m should return true for valid command[0m
    [32m  âœ”[0m[90m should return false for invalid command[0m
    [32m  âœ”[0m[90m should validate all known commands[0m
[0m    validateMessageData[0m
    [32m  âœ”[0m[90m should pass diag command[0m
    [32m  âœ”[0m[90m should pass webviewError command[0m
    [32m  âœ”[0m[90m should pass pong command[0m
    [32m  âœ”[0m[90m should pass requestThemeVariables command[0m
    [32m  âœ”[0m[90m should pass requestFontSettings command[0m
    [32m  âœ”[0m[90m should pass undo command[0m
    [32m  âœ”[0m[90m should pass redo command[0m
    [32m  âœ”[0m[90m should pass requestTableData command[0m
    [32m  âœ”[0m[90m should pass toggleAutoSave command[0m
    [32m  âœ”[0m[90m should pass manualSave command[0m
    [32m  âœ”[0m[90m should pass webviewUnhandledRejection command[0m
    [32m  âœ”[0m[90m should validate updateCell with valid data[0m
    [32m  âœ”[0m[90m should reject updateCell with missing row[0m
    [32m  âœ”[0m[90m should reject updateCell with negative row[0m
    [32m  âœ”[0m[90m should validate bulkUpdateCells with valid data[0m
    [32m  âœ”[0m[90m should reject bulkUpdateCells with non-array updates[0m
    [32m  âœ”[0m[90m should validate updateHeader with valid data[0m
    [32m  âœ”[0m[90m should reject updateHeader with missing col[0m
    [32m  âœ”[0m[90m should validate addRow with undefined data[0m
    [32m  âœ”[0m[90m should validate addRow with object data[0m
    [32m  âœ”[0m[90m should validate deleteRows with valid data[0m
    [32m  âœ”[0m[90m should reject deleteRows with negative indices[0m
    [32m  âœ”[0m[90m should validate addColumn with undefined data[0m
    [32m  âœ”[0m[90m should validate deleteColumns with valid data[0m
    [32m  âœ”[0m[90m should validate sort with valid data[0m
    [32m  âœ”[0m[90m should reject sort with invalid direction[0m
    [32m  âœ”[0m[90m should validate moveRow with indices[0m
    [32m  âœ”[0m[90m should validate moveRow with fromIndex[0m
    [32m  âœ”[0m[90m should reject moveRow with no indices or fromIndex[0m
    [32m  âœ”[0m[90m should reject moveRow with missing toIndex[0m
    [32m  âœ”[0m[90m should reject moveRow with negative toIndex[0m
    [32m  âœ”[0m[90m should reject moveRow with non-object data[0m
    [32m  âœ”[0m[90m should reject moveRow with empty indices[0m
    [32m  âœ”[0m[90m should reject moveRow with negative indices[0m
    [32m  âœ”[0m[90m should validate moveColumn with indices[0m
    [32m  âœ”[0m[90m should validate moveColumn with fromIndex[0m
    [32m  âœ”[0m[90m should reject moveColumn with no move data[0m
    [32m  âœ”[0m[90m should reject moveColumn with non-object data[0m
    [32m  âœ”[0m[90m should validate exportCSV with valid data[0m
    [32m  âœ”[0m[90m should reject exportCSV with empty csvContent[0m
    [32m  âœ”[0m[90m should reject exportCSV with missing csvContent[0m
    [32m  âœ”[0m[90m should reject exportCSV with non-string csvContent[0m
    [32m  âœ”[0m[90m should reject exportCSV with empty filename[0m
    [32m  âœ”[0m[90m should accept exportCSV with valid filename[0m
    [32m  âœ”[0m[90m should validate importCSV with undefined data[0m
    [32m  âœ”[0m[90m should validate switchTable with valid data[0m
    [32m  âœ”[0m[90m should reject switchTable with negative index[0m
    [32m  âœ”[0m[90m should return false for requestSync (falls through to default)[0m
    [32m  âœ”[0m[90m should return false for stateUpdate (falls through to default)[0m
    [32m  âœ”[0m[90m should return false for unknown command[0m
[0m  Webview-Extension Interface Tests[0m
[0m    Message Validation Tests[0m
    [32m  âœ”[0m[90m should validate valid undo message[0m
    [32m  âœ”[0m[90m should validate valid redo message[0m
    [32m  âœ”[0m[90m should validate valid requestTableData message[0m
    [32m  âœ”[0m[90m should validate valid updateCell message[0m
    [32m  âœ”[0m[90m should reject invalid updateCell message - missing data[0m
    [32m  âœ”[0m[90m should reject invalid updateCell message - invalid row index[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should validate valid sort message[0m
    [32m  âœ”[0m[90m should reject invalid sort message - invalid direction[0m
    [32m  âœ”[0m[90m should validate valid exportCSV message[0m
    [32m  âœ”[0m[90m should reject exportCSV message with empty filename[0m
    [32m  âœ”[0m[90m should validate pong message[0m
    [32m  âœ”[0m[90m should reject unknown command[0m
    [32m  âœ”[0m[90m should reject message without command[0m
[0m    Extension to Webview Communication Tests[0m
[MTE][Ext] Communication manager not found for panel: 
[MTE][Ext] Communication manager not found for sendError
    [32m  âœ”[0m[90m should send updateTableData message correctly[0m
    [32m  âœ”[0m[90m should send error message correctly[0m
    [32m  âœ”[0m[90m should send success message correctly[0m
    [32m  âœ”[0m[90m should send status update correctly[0m
    [32m  âœ”[0m[90m should send validation error correctly[0m
    [32m  âœ”[0m[90m should broadcast message to multiple panels[0m
[0m    Health Monitoring Interface Tests[0m
    [32m  âœ”[0m[90m should handle ping-pong health check[0m
    [32m  âœ”[0m[90m should mark connection as healthy after receiving message[0m
[WebviewManager] broadcastMessage("testCommand"): No active panels to broadcast to
[MTE][Ext] Communication manager not found for sendError
    [32m  âœ”[0m[90m should handle connection as unhealthy[0m
[0m    Message Retry Logic Interface Tests[0m
Failed to send message, retrying (1/3): Error: Simulated network failure
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webview-extension-interface.test.js:350:35)
	at attemptSend (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1355:35)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1370:13
	at new Promise (<anonymous>)
	at WebviewManager.sendMessageWithRetry (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1351:16)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webview-extension-interface.test.js:358:34)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should retry message sending on failure[0m[31m (1003ms)[0m
Failed to send message, retrying (1/2): Error: Persistent failure
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webview-extension-interface.test.js:365:31)
	at attemptSend (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1355:35)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1370:13
	at new Promise (<anonymous>)
	at WebviewManager.sendMessageWithRetry (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1351:16)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webview-extension-interface.test.js:371:38)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
Failed to send message after 2 retries: Error: Persistent failure
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webview-extension-interface.test.js:365:31)
	at Timeout.attemptSend [as _onTimeout] (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1355:35)
	at listOnTimeout (node:internal/timers:588:17)
	at process.processTimers (node:internal/timers:523:7)
    [32m  âœ”[0m[90m should throw after exhausting retries[0m[31m (1002ms)[0m
    [32m  âœ”[0m[90m should handle updateTableDataWithRetry[0m
[0m    Command Handling Interface Tests[0m
    [32m  âœ”[0m[90m should handle message validation failure gracefully[0m
[MTE][Ext] Communication manager not found for sendError
    [32m  âœ”[0m[90m should handle unknown command gracefully[0m
    [32m  âœ”[0m[90m should track connection health when receiving messages[0m
[0m    Panel Management Interface Tests[0m
    [32m  âœ”[0m[90m should track panel existence correctly[0m
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
    [32m  âœ”[0m[90m should handle panel disposal cleanup[0m
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
[0m  Webview Interface Mock Tests[0m
[0m    Mock VSCode API Tests[0m
    [32m  âœ”[0m[90m should initialize with empty state[0m
    [32m  âœ”[0m[90m should track sent messages[0m
    [32m  âœ”[0m[90m should handle state management[0m
    [32m  âœ”[0m[90m should register and trigger message handlers[0m
    [32m  âœ”[0m[90m should simulate extension responses[0m
    [32m  âœ”[0m[90m should create mock table data with correct structure[0m
    [32m  âœ”[0m[90m should simulate error responses[0m
[0m    Mock TableEditor Tests[0m
    [32m  âœ”[0m[90m should initialize with correct state structure[0m
    [32m  âœ”[0m[90m should send requestTableData message[0m
    [32m  âœ”[0m[90m should send updateCell message with correct data[0m
    [32m  âœ”[0m[90m should send table structure modification messages[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should send sorting and moving messages[0m
    [32m  âœ”[0m[90m should send exportCSV message with encoding[0m
    [32m  âœ”[0m[90m should handle incoming updateTableData message[0m
    [32m  âœ”[0m[90m should handle ping-pong health check[0m
    [32m  âœ”[0m[90m should handle error messages[0m
Display updated with table data: [ 'Name', 'Age', 'City' ]
    [32m  âœ”[0m[90m should handle validation errors[0m
    [32m  âœ”[0m[90m should maintain state correctly during operations[0m
Webview Success: Cell updated successfully
Display updated with table data: [ 'Name', 'Age', 'City' ]
Webview Success: Row added successfully
Display updated with table data: [ 'Name', 'Age', 'City' ]
Webview Success: Row deleted successfully
Display updated with table data: [ 'Name', 'Age', 'City', 'Country' ]
Webview Success: Column added successfully
Display updated with table data: [ 'Name', 'Age' ]
Webview Success: Column deleted successfully
[0m    Interface Integration Mock Tests[0m
Display updated with table data: [ 'Name', 'Age', 'City' ]
Webview Success: Table sorted by column 1 (desc)
Display updated with table data: [ 'Name', 'Age', 'City' ]
Webview Success: Row moved from 0 to 2
Display updated with table data: [ 'Age', 'City', 'Name' ]
Webview Success: Column moved from 1 to 0
Webview Success: CSV exported successfully to export.csv
    [32m  âœ”[0m[90m should complete full requestTableData workflow[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should complete full updateCell workflow[0m
    [32m  âœ”[0m[90m should handle table modification workflow[0m
    [32m  âœ”[0m[90m should handle multiple operations in sequence[0m
[0m  webviewHtmlBuilder Test Suite[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should generate valid HTML with DOCTYPE[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include Content-Security-Policy meta tag[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include bootstrap script[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include root div for React app[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include noscript fallback[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include script module reference[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include CSS stylesheet link[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include CSP directives for style, script, img, font[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include language attribute from vscode.env.language[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include error and unhandledrejection handlers in bootstrap[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include viewport meta tag[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include charset meta tag[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include diag-installed event in bootstrap[0m
[MTE][Ext] webviewHtmlBuilder - CSS URI resolved: vscode-webview:/mock/extension/out/webview/assets/index.css
[MTE][Ext] buildWebviewHtml - Generated HTML head: <!DOCTYPE html>
<html lang="en" data-vscode-language="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'none'; style-src 'unsafe-inline' https://mock.csp.source; script-src 'unsafe-inline' 'unsafe-eval' https://mock.csp.source; img-src https://mock.csp.source https: data:; font-src https://mock.csp.source https:">
    <title>Markdown Table Editor</title>
    
    <
  [32m  âœ”[0m[90m should include title tag[0m
[0m  WebviewManager Test Suite[0m
  [32m  âœ”[0m[90m should create singleton instance[0m
  [32m  âœ”[0m[90m should track panel count correctly[0m
  [32m  âœ”[0m[90m should check panel existence[0m
  [32m  âœ”[0m[90m should get active panel URIs[0m
  [32m  âœ”[0m[90m should validate message structure - valid message[0m
[MTE][Ext] Communication manager not found for sendError
  [32m  âœ”[0m[90m should handle sendError without throwing[0m
  [32m  âœ”[0m[90m should handle sendSuccess without throwing[0m
  [32m  âœ”[0m[90m should handle sendStatus without throwing[0m
  [32m  âœ”[0m[90m should handle sendValidationError without throwing[0m
[WebviewManager] broadcastMessage("testCommand"): No active panels to broadcast to
  [32m  âœ”[0m[90m should handle broadcastMessage without throwing[0m
Failed to send message, retrying (1/3): Error: Simulated failure
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:163:31)
	at attemptSend (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1355:35)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1370:13
	at new Promise (<anonymous>)
	at WebviewManager.sendMessageWithRetry (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1351:16)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:170:30)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Webview Success: Cell updated successfully
Display updated with table data: [ 'Name', 'Age', 'City' ]
Webview Success: Row added successfully
Display updated with table data: [ 'Name', 'Age', 'City' ]
Webview Success: Table sorted by column 0 (asc)
Webview Success: CSV exported successfully to test.csv
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m should handle message retry logic[0m[31m (1001ms)[0m
Failed to send message, retrying (1/2): Error: Persistent failure
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:177:27)
	at attemptSend (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1355:35)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1370:13
	at new Promise (<anonymous>)
	at WebviewManager.sendMessageWithRetry (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1351:16)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:182:34)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
Failed to send message after 2 retries: Error: Persistent failure
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:177:27)
	at Timeout.attemptSend [as _onTimeout] (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1355:35)
	at listOnTimeout (node:internal/timers:588:17)
	at process.processTimers (node:internal/timers:523:7)
  [32m  âœ”[0m[90m should handle retry exhaustion[0m[31m (1006ms)[0m
[ExtComm] Sync interval triggered
  [32m  âœ”[0m[90m should update table data with retry[0m
  [32m  âœ”[0m[90m hasActivePanel returns false when no panels[0m
  [32m  âœ”[0m[90m getActivePanelUri returns null when no panels[0m
  [32m  âœ”[0m[90m getPanel with string returns null for non-existent[0m
  [32m  âœ”[0m[90m getPanel with Uri returns null for non-existent[0m
  [32m  âœ”[0m[90m getPanelId returns string from uri[0m
  [32m  âœ”[0m[90m communicationManagerCount is 0 initially[0m
  [32m  âœ”[0m[90m isAutoSaveEnabled returns true by default for unknown panel[0m
  [32m  âœ”[0m[90m setDirtyState does not throw for unknown panel[0m
  [32m  âœ”[0m[90m setDirtyState with known panel updates state[0m
[WebviewManager] broadcastNotification("testNotify"): No active communication managers
  [32m  âœ”[0m[90m broadcastNotification with no managers does not throw[0m
  [32m  âœ”[0m[90m broadcastMessage sends to all panels[0m
[WebviewManager] Failed to post message "testCmd" to panel: Error: Failed
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:277:51)
	at WebviewManager.broadcastMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:295:31)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:281:28
	at getActual (node:assert:609:5)
	at Object.doesNotThrow (node:assert:777:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:280:16)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m broadcastMessage handles error in postMessage[0m
  [32m  âœ”[0m[90m validateMessage with valid command returns true[0m
  [32m  âœ”[0m[90m validateMessage with missing command returns false[0m
  [32m  âœ”[0m[90m validateMessage with null returns false[0m
[MTE][Ext] Communication manager not found for sendError
  [32m  âœ”[0m[90m sendError without comm manager uses fallback[0m
[MTE][Ext] Communication manager not found for sendOperationSuccess
  [32m  âœ”[0m[90m sendOperationSuccess without comm manager uses fallback[0m
[MTE][Ext] Communication manager not found for sendCellUpdateError
  [32m  âœ”[0m[90m sendCellUpdateError without comm manager does not throw[0m
[MTE][Ext] Communication manager not found for sendHeaderUpdateError
  [32m  âœ”[0m[90m sendHeaderUpdateError without comm manager does not throw[0m
[MTE][Ext] Communication manager not found for panel: 
  [32m  âœ”[0m[90m updateTableData without comm manager logs warning[0m
[MTE][Ext] Communication manager not found for updateGitDiff
  [32m  âœ”[0m[90m updateGitDiff without comm manager logs warning[0m
[MTE][Ext] Communication manager not found for setActiveTable
  [32m  âœ”[0m[90m setActiveTable without comm manager logs warning[0m
  [32m  âœ”[0m[90m closePanel with non-existent URI does not throw[0m
  [32m  âœ”[0m[90m closeAllPanels with no panels does not throw[0m
  [32m  âœ”[0m[90m getPanelsForFile returns empty map for unknown URI[0m
  [32m  âœ”[0m[90m getPanelsForFile returns panels matching URI prefix[0m
  [32m  âœ”[0m[90m getCommunicationManager returns null for unknown panel[0m
WebviewManager: Starting async initialization...
WebviewManager: Disposing resources...
WebviewManager: Resources disposed
WebviewManager: Starting async initialization...
  [32m  âœ”[0m[90m dispose stops health monitoring and clears maps[0m
  [32m  âœ”[0m[90m private findPanelId returns empty for unknown panel[0m
  [32m  âœ”[0m[90m private findPanelId returns key for known panel[0m
  [32m  âœ”[0m[90m private getSafeUriString returns URI string[0m
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
Invalid URI provided: null
  [32m  âœ”[0m[90m private getSafeUriString returns empty for null[0m
  [32m  âœ”[0m[90m private buildInitialThemeCssSync returns CSS[0m
  [32m  âœ”[0m[90m private getFallbackHtml returns HTML[0m
  [32m  âœ”[0m[90m private markConnectionHealthy sets healthy state[0m
  [32m  âœ”[0m[90m private markConnectionUnhealthy sets unhealthy state[0m
  [32m  âœ”[0m[90m private performHealthCheck handles stale connections[0m
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
WebviewManager: Async initialization completed
WebviewManager: Async initialization completed
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
Failed to ping webview ping-err-test: Error: Ping err
	at Object.postMessage (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:436:51)
	at WebviewManager.pingWebview (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1318:27)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:438:24)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
  [32m  âœ”[0m[90m private pingWebview handles error[0m
  [32m  âœ”[0m[90m private stopHealthMonitoring clears interval[0m
  [32m  âœ”[0m[90m private getAppropriateViewColumn returns correct columns[0m
[0m    createTableEditorPanel[0m
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should create panel successfully with mock React build[0m[33m (53ms)[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[ExtComm] Sync interval triggered
[MTE][Ext] All communication handlers registered
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'command', 'data', 'fileInfo', 'gitThemeColors' ] }
    [32m  âœ”[0m[90m should reuse existing panel for same file[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[MTE][Ext] All communication handlers registered
[ExtComm] Disposing communication manager
[MTE][Ext] All communication handlers registered
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'command', 'data', 'fileInfo', 'gitThemeColors' ] }
    [32m  âœ”[0m[90m should reuse existing panel for different file (single panel mode)[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should create new panel when forceNewPanel is true[0m
[0m    updatePanelTitle[0m
    [32m  âœ”[0m[90m should add dirty indicator when auto save off and dirty[0m
    [32m  âœ”[0m[90m should not add dirty indicator when auto save is on[0m
    [32m  âœ”[0m[90m should add panel number for multiple panels[0m
[0m    setDirtyState extended[0m
    [32m  âœ”[0m[90m should notify comm manager of dirty state[0m
[0m    broadcastNotification[0m
[ExtComm] Sync interval triggered
    [32m  âœ”[0m[90m should send notification to all comm managers[0m
[WebviewManager] Failed to send notification "testNotif": Error: send fail
	at Object.sendNotification (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:607:49)
	at WebviewManager.broadcastNotification (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:314:29)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:611:32
	at getActual (node:assert:609:5)
	at Object.doesNotThrow (node:assert:777:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:610:20)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
    [32m  âœ”[0m[90m should handle error in sendNotification[0m
[0m    applyTableState[0m
    [32m  âœ”[0m[90m should execute directFileUpdate command[0m
[0m    performHealthCheck extended[0m
    [32m  âœ”[0m[90m should skip healthy connections[0m
    [32m  âœ”[0m[90m should handle no panels[0m
[0m    getSafeUriString edge cases[0m
    [32m  âœ”[0m[90m should handle Uri with special characters[0m
Invalid URI provided: undefined
    [32m  âœ”[0m[90m should handle undefined[0m
[0m    initializeAsync[0m
    [32m  âœ”[0m[90m should complete async initialization[0m
[0m    ensureInitialized[0m
    [32m  âœ”[0m[90m should resolve when already initialized[0m
[0m    hasActivePanel and getActivePanelUri with panels[0m
    [32m  âœ”[0m[90m should return true and URI when panel exists[0m
[0m    getPanel overloads[0m
    [32m  âœ”[0m[90m should return panel for matching string panelId[0m
    [32m  âœ”[0m[90m should return panel for matching Uri[0m
[0m    createDefaultContext[0m
    [32m  âœ”[0m[90m should create default extension context[0m
[0m    updatePanelTitle - panelId lookup[0m
    [32m  âœ”[0m[90m should set base title when panel not in panels map[0m
[0m    handleSort[0m
Invalid sort data: null
Invalid sort direction: invalid
    [32m  âœ”[0m[90m should reject invalid sort data[0m
[0m    handleMoveRow[0m
Failed to move row: Invalid row indices: from undefined, to -1, indices=undefined
    [32m  âœ”[0m[90m should send error for invalid indices[0m
    [32m  âœ”[0m[90m should execute command for valid indices[0m
Failed to execute moveRow command: Error: test
    [32m  âœ”[0m[90m should handle executeCommand throwing[0m
[0m    handleMoveColumn[0m
Failed to move column: Invalid column indices: from undefined, to -1, indices=undefined
    [32m  âœ”[0m[90m should send error for invalid indices[0m
    [32m  âœ”[0m[90m should execute command for valid indices[0m
Failed to execute moveColumn command: Error: col-err
    [32m  âœ”[0m[90m should handle executeCommand throwing[0m
[0m    handleCellUpdate[0m
    [32m  âœ”[0m[90m should execute updateCell command[0m
Failed to create safe URI string for cell update operation
    [32m  âœ”[0m[90m should return early when getSafeUriString returns empty[0m
[0m    handleHeaderUpdate[0m
    [32m  âœ”[0m[90m should execute updateHeader command[0m
Failed to create safe URI string for header update operation
    [32m  âœ”[0m[90m should return early when getSafeUriString returns empty[0m
[0m    handleAddRow[0m
    [32m  âœ”[0m[90m should execute addRow command[0m
[0m    handleDeleteRows[0m
    [32m  âœ”[0m[90m should execute deleteRows command[0m
[0m    handleAddColumn[0m
    [32m  âœ”[0m[90m should execute addColumn command[0m
[0m    handleDeleteColumns[0m
    [32m  âœ”[0m[90m should execute deleteColumns command[0m
[0m    handleBulkUpdateCells[0m
[MTE][UndoRedo] Failed to save state: CodeExpectedError: cannot open file:///test/bulk.md. Detail: Unable to read file '/test/bulk.md' (Error: Unable to resolve nonexistent file '/test/bulk.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
    [32m  âœ”[0m[90m should execute bulkUpdateCells command[0m
[0m    handleSwitchTable[0m
[MTE][Ext] Handling switchTable to index: 1
[MTE][Ext] Communication manager not found for setActiveTable
    [32m  âœ”[0m[90m should execute requestTableData and setActiveTable[0m
[0m    handleExportCSV[0m
    [32m  âœ”[0m[90m should execute exportCSV command[0m
[0m    handleImportCSV[0m
    [32m  âœ”[0m[90m should execute importCSV command[0m
[0m    handleUndo[0m
[MTE][Ext] Executing custom undo (no focus change required)
[MTE][Ext] Before undo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m should call undo and handle success[0m
[0m    handleRedo[0m
[MTE][Ext] Executing custom redo (no focus change required)
[MTE][Ext] Before redo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m should call redo and handle no-op[0m
[0m    handleRequestTableData[0m
    [32m  âœ”[0m[90m should execute requestTableData command[0m
[0m    handleRequestThemeVariables[0m
[MTE][Ext] Communication manager not found for applyThemeToPanel
    [32m  âœ”[0m[90m should not throw[0m
[0m    handleRequestFontSettings[0m
[MTE][Ext] Communication manager not found for applyFontSettingsToPanel
    [32m  âœ”[0m[90m should not throw[0m
[0m    refreshPanelData[0m
    [32m  âœ”[0m[90m should execute requestTableData command[0m
[0m    getWebviewContent[0m
Reading HTML from path: /test/webview/tableEditor.html
Error reading webview HTML file: Error: ENOENT: no such file or directory, open '/test/webview/tableEditor.html'
	at Object.readFileSync (node:fs:442:20)
	at t.readFileSync (node:electron/js2c/node_init:2:11013)
	at WebviewManager.getWebviewContent (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1173:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1039:41)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Using fallback HTML
    [32m  âœ”[0m[90m should return fallback HTML when file not found[0m
[0m    setupCommunicationHandlers[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should register all handlers on comm manager[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should invoke registered handlers correctly[0m
[0m    updateTableData with comm manager[0m
    [32m  âœ”[0m[90m should send via communication manager when available[0m
[MTE][Ext] Failed to send via communication manager: Error: comm fail
	at Object.updateTableData (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1149:48)
	at WebviewManager.updateTableData (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:636:29)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1156:32
	at getActual (node:assert:609:5)
	at Object.doesNotThrow (node:assert:777:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1155:20)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
    [32m  âœ”[0m[90m should handle comm manager error gracefully[0m
[0m    updateGitDiff with comm manager[0m
    [32m  âœ”[0m[90m should send via communication manager[0m
[0m    setActiveTable with comm manager[0m
    [32m  âœ”[0m[90m should send via communication manager[0m
[0m    sendError with comm manager[0m
    [32m  âœ”[0m[90m should send via communication manager[0m
[0m    sendOperationSuccess with comm manager[0m
    [32m  âœ”[0m[90m should send via communication manager[0m
[0m    sendCellUpdateError with comm manager[0m
    [32m  âœ”[0m[90m should send via communication manager[0m
[0m    sendHeaderUpdateError with comm manager[0m
    [32m  âœ”[0m[90m should send via communication manager[0m
[0m    closePanel with existing panel[0m
    [32m  âœ”[0m[90m should dispose existing panel[0m
[0m    closeAllPanels with panels[0m
    [32m  âœ”[0m[90m should dispose all panels[0m
[0m    applyThemeToPanel[0m
    [32m  âœ”[0m[90m should apply theme via comm manager[0m
[MTE][Ext] Communication manager not found for applyThemeToPanel
    [32m  âœ”[0m[90m should handle missing comm manager[0m
[0m    applyFontSettingsToPanel[0m
    [32m  âœ”[0m[90m should apply font via comm manager[0m
[MTE][Ext] Communication manager not found for applyFontSettingsToPanel
    [32m  âœ”[0m[90m should handle missing comm manager[0m
[0m    getSafeUriString fallback paths[0m
Invalid URI provided: { scheme: '', path: '/test' }
Invalid URI scheme detected: 123invalid Full URI: 123invalid:///test/file.md
Failed to create safe URI string: Error: toString failed
	at Object.toString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1366:41)
	at WebviewManager.getSafeUriString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:27:35)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1368:43)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
    [32m  âœ”[0m[90m should return empty for URI with no scheme (L42-43)[0m
    [32m  âœ”[0m[90m should warn for invalid scheme but still return URI string (L53-55)[0m
Reconstructed URI: file:///fallback/test.md
    [32m  âœ”[0m[90m should enter error fallback when toString throws (L58-74)[0m
Reconstructed URI: file:///
    [32m  âœ”[0m[90m should return empty when URI has no path and all fallbacks fail[0m
Original URI: {
  scheme: 'file',
  path: '/fallback/test.md',
  query: '',
  fragment: '',
  fsPath: '/fallback/test.md'
}
Failed to create safe URI string: Error: toString failed
	at Object.toString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1379:41)
	at WebviewManager.getSafeUriString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:27:35)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1381:43)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Original URI: { scheme: 'file', path: '', query: '', fragment: '', fsPath: '' }
Invalid URI string format: f:/a
Failed to create safe URI string: Error: Invalid URI format
	at WebviewManager.getSafeUriString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:31:23)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1394:43)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Original URI: { scheme: 'file', path: '/a', query: '', fragment: '', fsPath: '/a' }
Reconstructed URI: file:///a
    [32m  âœ”[0m[90m should handle short URI string that triggers format error (L47)[0m
Failed to create safe URI string: Error: toString exploded
	at Object.toString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1410:41)
	at WebviewManager.getSafeUriString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:27:35)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1412:43)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Original URI: {
  scheme: 'file',
  path: '/deep/fallback/test.md',
  query: '',
  fragment: '',
  fsPath: '/deep/fallback/test.md'
}
Invalid URI provided: {}
Reconstructed URI: file:///deep/fallback/test.md
    [32m  âœ”[0m[90m should use file path fallback when reconstruct fails (L83-87)[0m
    [32m  âœ”[0m[90m should return empty when all fallbacks fail (L93-94)[0m
[0m    legacyScriptFiles property[0m
    [32m  âœ”[0m[90m should have legacy script files defined[0m
[0m    handleUndo success path[0m
[MTE][Ext] Executing custom undo (no focus change required)
[MTE][Ext] Before undo: { undoCount: 0, redoCount: 0 }
[MTE][Ext] After undo: { undoCount: 0, redoCount: 0 }
[MTE][Ext] Undo completed successfully
    [32m  âœ”[0m[90m should refresh panel data on successful undo[0m
[MTE][Ext] Executing custom undo (no focus change required)
[MTE][Ext] Before undo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m should show warning when undo returns false[0m
[MTE][Ext] Executing custom undo (no focus change required)
[MTE][Ext] Before undo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m should show error when undo throws[0m
[MTE][Ext] Undo command failed: Error: Undo internal error
	at undoRedoManager.undo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1482:56)
	at WebviewManager.handleUndo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:754:56)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1485:34)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[0m    handleRedo success path[0m
[MTE][Ext] Executing custom redo (no focus change required)
[MTE][Ext] Before redo: { undoCount: 0, redoCount: 0 }
[MTE][Ext] After redo: { undoCount: 0, redoCount: 0 }
[MTE][Ext] Redo completed successfully
    [32m  âœ”[0m[90m should refresh panel data on successful redo[0m
[MTE][Ext] Executing custom redo (no focus change required)
[MTE][Ext] Before redo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m should show warning when redo returns false[0m
[MTE][Ext] Executing custom redo (no focus change required)
[MTE][Ext] Before redo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m should show error when redo throws[0m
[MTE][Ext] Redo command failed: Error: Redo internal error
	at undoRedoManager.redo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1531:56)
	at WebviewManager.handleRedo (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:784:56)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1534:34)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
[0m    handleSort valid operations[0m
    [32m  âœ”[0m[90m should execute sort command for valid asc direction[0m
    [32m  âœ”[0m[90m should execute sort command for valid desc direction[0m
    [32m  âœ”[0m[90m should execute sort command for none direction[0m
    [32m  âœ”[0m[90m should pass safeUriString and tableIndex to sort command[0m
[0m    dispose with communication managers[0m
WebviewManager: Starting async initialization...
WebviewManager: Disposing resources...
[MTE][Ext] Communication manager disposed for panel: panel-1
[MTE][Ext] Communication manager disposed for panel: panel-2
WebviewManager: Resources disposed
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should dispose all comm managers during dispose[0m
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
WebviewManager: Starting async initialization...
WebviewManager: Disposing resources...
Error disposing communication manager: Error: dispose fail
	at Object.dispose (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1621:58)
	at WebviewManager.dispose (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1101:29)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1625:52
	at getActual (node:assert:609:5)
	at Object.doesNotThrow (node:assert:777:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1625:20)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
WebviewManager: Resources disposed
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle comm manager dispose error gracefully[0m
WebviewManager: Async initialization completed
WebviewManager: Async initialization completed
WebviewManager: Starting async initialization...
WebviewManager: Disposing resources...
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
Error disposing panel: Error: panel dispose fail
	at Object.dispose (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1632:56)
	at WebviewManager.dispose (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:1112:23)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1634:52
	at getActual (node:assert:609:5)
	at Object.doesNotThrow (node:assert:777:32)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1634:20)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
WebviewManager: Resources disposed
WebviewManager: Starting async initialization...
    [32m  âœ”[0m[90m should handle panel dispose error gracefully[0m
WebviewManager: Async initialization completed
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
WebviewManager: Async initialization completed
[0m    createPanel panel reuse with health/comm migration[0m
WebviewManager: Async initialization completed
WebviewManager: Async initialization completed
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
WebviewManager: React build directory not found, this may cause issues: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:110:17)
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
WebviewManager: React build index.html not found: EntryNotFound (FileSystemError): Error: ENOENT: no such file or directory, stat '/test/out/webview/index.html'
	at Lr.e (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:18080)
	at Object.stat (file:///Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/api/node/extensionHostProcess.js:116:16027)
	at async WebviewManager.initializeAsync (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:119:17)
	at async WebviewManager.ensureInitialized (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:138:13)
	at async WebviewManager._createTableEditorPanel (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:367:9)
	at async WebviewManager.createTableEditorPanel (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:350:16)
	at async Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:1666:28)
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[MTE][Ext] All communication handlers registered
[ExtComm] Disposing communication manager
[MTE][Ext] All communication handlers registered
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'command', 'data', 'fileInfo', 'gitThemeColors' ] }
    [32m  âœ”[0m[90m should migrate health mapping when reusing panel for different file[0m
[ExtComm] Sync interval triggered
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[MTE][Ext] All communication handlers registered
[ExtComm] Disposing communication manager
[MTE][Ext] All communication handlers registered
[ExtComm] Sending updateTableData to webview, preview: { keys: [ 'command', 'data', 'fileInfo', 'gitThemeColors' ] }
    [32m  âœ”[0m[90m should dispose old comm manager when reusing panel[0m
[0m    createPanel force new panel unique panelId[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[ExtComm] Sync interval triggered
[MTE][Ext] All communication handlers registered
[MTE][Ext] Panel state changed (inactive or hidden): {
  active: false,
  visible: false,
  panelId: 'file:///test/sample.md_1771031974759'
}
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should generate unique panelId for forceNewPanel[0m
[0m    createPanel HTML processing[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[ExtComm] Sync interval triggered
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should replace relative and absolute asset paths[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
Webview.loadLocalResource - Error using fileReader. requestUri=file:///var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/mte-test-build/out/webview/assets/index.js, resourceToLoad=file:///var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/mte-test-build/out/webview/assets/index.js
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should add CSP meta tag to head[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[ExtComm] Sync interval triggered
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should remove existing CSP meta tags before adding new one[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m should add lang attribute to html tag[0m
[MTE][Ext] Panel state changed (inactive or hidden): { active: false, visible: false, panelId: '' }
React build directory not found: file:///nonexistent-path-for-test/out/webview
[ExtComm] Sync interval triggered
Webview.loadLocalResource - Error using fileReader. requestUri=file:///var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/mte-test-build/out/webview/assets/index.js, resourceToLoad=file:///var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/mte-test-build/out/webview/assets/index.js
Webview.loadLocalResource - Error using fileReader. requestUri=file:///var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/mte-test-build/out/webview/assets/other.js, resourceToLoad=file:///var/folders/cy/7wzv1l2n1w90ccrz9qr0x1m40000gn/T/mte-test-build/out/webview/assets/other.js
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
React build directory not found: file:///nonexistent-path-for-test/out/webview
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
React build directory not found: file:///nonexistent-path-for-test/out/webview
All build loading attempts failed
    [32m  âœ”[0m[90m should throw when build directory does not exist[0m[31m (216ms)[0m
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
[ExtComm] Sync interval triggered
All build loading attempts failed
    [32m  âœ”[0m[90m should throw when readFile returns empty HTML after retries[0m[31m (229ms)[0m
[0m    setupCommunicationHandlers callback execution[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m requestTableData handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m updateCell handler should return success[0m
[MTE][Ext] All communication handlers registered
[MTE][UndoRedo] Failed to save state: CodeExpectedError: cannot open file:///test/handler-cb.md. Detail: Unable to read file '/test/handler-cb.md' (Error: Unable to resolve nonexistent file '/test/handler-cb.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
    [32m  âœ”[0m[90m bulkUpdateCells handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m updateHeader handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m addRow handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m deleteRows handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m addColumn handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m deleteColumns handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m sort handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m moveRow handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m moveColumn handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m exportCSV handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m importCSV handler should return success[0m
[MTE][Ext] All communication handlers registered
[MTE][Ext] Handling switchTable to index: 1
    [32m  âœ”[0m[90m switchTable handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m requestThemeVariables handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m requestFontSettings handler should return success[0m
[MTE][Ext] All communication handlers registered
[MTE][Ext] Executing custom undo (no focus change required)
[MTE][Ext] Before undo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m undo handler should return success[0m
[MTE][Ext] All communication handlers registered
[MTE][Ext] Executing custom redo (no focus change required)
[MTE][Ext] Before redo: { undoCount: 0, redoCount: 0 }
    [32m  âœ”[0m[90m redo handler should return success[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m pong handler should mark connection healthy[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m requestSync handler should refresh data[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m stateUpdate handler with ready=true should apply theme and font[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m stateUpdate handler with ready=undefined should apply theme and font[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m stateUpdate handler with ready=false should not apply theme[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m toggleAutoSave handler should update setting and notify[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m toggleAutoSave handler defaults to true when enabled not provided[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m manualSave handler should trigger save when dirty[0m
[MTE][Ext] All communication handlers registered
    [32m  âœ”[0m[90m manualSave handler should skip save when not dirty[0m
[0m    handleMoveRow with fromIndex only[0m
    [32m  âœ”[0m[90m should use fromIndex when indices not provided[0m
[0m    handleMoveColumn with fromIndex only[0m
    [32m  âœ”[0m[90m should use fromIndex when indices not provided[0m
[0m    handleMoveRow with executeCommand throwing[0m
Failed to execute moveRow command: Error: test
    [32m  âœ”[0m[90m should send error when executeCommand throws[0m
[0m    handleMoveColumn with executeCommand throwing[0m
Failed to execute moveColumn command: Error: col-err
    [32m  âœ”[0m[90m should send error when executeCommand throws[0m
[0m    handleSwitchTable with comm manager[0m
[MTE][Ext] Handling switchTable to index: 2
    [32m  âœ”[0m[90m should call setActiveTable via comm manager[0m
[0m    handleExportCSV with all parameters[0m
    [32m  âœ”[0m[90m should pass all data fields to command[0m
[0m    handleBulkUpdateCells with tableIndex[0m
[MTE][UndoRedo] Failed to save state: CodeExpectedError: cannot open file:///test/bulk-idx.md. Detail: Unable to read file '/test/bulk-idx.md' (Error: Unable to resolve nonexistent file '/test/bulk-idx.md')
    at Yze.$tryOpenDocument (vscode-file://vscode-app/Users/tyngw/Documents/workspace/markdown-table-editor/.vscode-test/vscode-darwin-arm64-1.109.3/Visual%20Studio%20Code.app/Contents/Resources/app/out/vs/workbench/workbench.desktop.main.js:542:8529)
    [32m  âœ”[0m[90m should pass tableIndex to command[0m
[0m    performHealthCheck with no existing health entry[0m
    [32m  âœ”[0m[90m should create health entry and ping when no prior entry[0m
[0m    pingWebview success path[0m
    [32m  âœ”[0m[90m should post ping message successfully[0m
[0m    getCommunicationManagers[0m
    [32m  âœ”[0m[90m should return the internal communication managers map[0m
[0m    ensureInitialized edge case[0m
    [32m  âœ”[0m[90m should wait for initialization if not yet done[0m
    [32m  âœ”[0m[90m should pass through when no initialization promise[0m
[0m    getSafeUriString Uri.from reconstruction success[0m
Failed to create safe URI string: Error: toString broken
	at Object.toString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:2213:41)
	at WebviewManager.getSafeUriString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:27:35)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:2215:43)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Original URI: {
  scheme: 'file',
  path: '/reconstruct/success.md',
  query: 'q=1',
  fragment: 'frag',
  fsPath: '/reconstruct/success.md'
}
Reconstructed URI: file:///reconstruct/success.md?q%3D1#frag
    [32m  âœ”[0m[90m should reconstruct URI via Uri.from when toString throws but components are valid[0m
Failed to create safe URI string: Error: toString broken
	at Object.toString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:2228:41)
	at WebviewManager.getSafeUriString (/Users/tyngw/Documents/workspace/markdown-table-editor/out/src/webviewManager.js:27:35)
	at Context.<anonymous> (/Users/tyngw/Documents/workspace/markdown-table-editor/out/test/unit/webviewManager.test.js:2230:43)
	at callFn (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:364:21)
	at Runnable.run (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runnable.js:352:5)
	at Runner.runTest (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:677:10)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:800:12
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:592:14)
	at /Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:602:7
	at next (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:485:14)
	at Immediate._onImmediate (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/mocha/lib/runner.js:570:5)
	at process.processImmediate (node:internal/timers:485:21)
Original URI: {
  scheme: 'untitled',
  path: '/untitled/test.md',
  query: '',
  fragment: '',
  fsPath: '/untitled/test.md'
}
Reconstructed URI: file:///untitled/test.md
    [32m  âœ”[0m[90m should map untitled scheme to file in reconstruction[0m
[0m    getSafeUriString final fallback failure[0m
[ExtComm] Sync interval triggered
[90m[main 2026-02-14T01:19:35.318Z][0m Extension host with pid 7155 exited with code: 7, signal: unknown.
[91m[main 2026-02-14T01:19:35.326Z][0m [UtilityProcess id: 1, type: extensionHost, pid: 7155]: crashed with code 1792 and reason 'abnormal-exit'
Exit code:   7
Failed to run tests: TestRunFailedError: Test run failed with code 7
    at ChildProcess.onProcessClosed (/Users/tyngw/Documents/workspace/markdown-table-editor/node_modules/@vscode/test-electron/out/runTest.js:110:24)
    at ChildProcess.emit (node:events:524:28)
    at ChildProcess._handle.onexit (node:internal/child_process:293:12) {
  code: 7,
  signal: undefined
}
